<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>
  <meta charset="utf-8" />
  <meta name="generator" content="pandoc" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
  <title>d4d8bb4c6ae6419a97ff5973297b3bc8</title>
  <style>
    html {
      line-height: 1.5;
      font-family: Georgia, serif;
      font-size: 20px;
      color: #1a1a1a;
      background-color: #fdfdfd;
    }
    body {
      margin: 0 auto;
      max-width: 36em;
      padding-left: 50px;
      padding-right: 50px;
      padding-top: 50px;
      padding-bottom: 50px;
      hyphens: auto;
      overflow-wrap: break-word;
      text-rendering: optimizeLegibility;
      font-kerning: normal;
    }
    @media (max-width: 600px) {
      body {
        font-size: 0.9em;
        padding: 1em;
      }
      h1 {
        font-size: 1.8em;
      }
    }
    @media print {
      body {
        background-color: transparent;
        color: black;
        font-size: 12pt;
      }
      p, h2, h3 {
        orphans: 3;
        widows: 3;
      }
      h2, h3, h4 {
        page-break-after: avoid;
      }
    }
    p {
      margin: 1em 0;
    }
    a {
      color: #1a1a1a;
    }
    a:visited {
      color: #1a1a1a;
    }
    img {
      max-width: 100%;
    }
    h1, h2, h3, h4, h5, h6 {
      margin-top: 1.4em;
    }
    h5, h6 {
      font-size: 1em;
      font-style: italic;
    }
    h6 {
      font-weight: normal;
    }
    ol, ul {
      padding-left: 1.7em;
      margin-top: 1em;
    }
    li > ol, li > ul {
      margin-top: 0;
    }
    blockquote {
      margin: 1em 0 1em 1.7em;
      padding-left: 1em;
      border-left: 2px solid #e6e6e6;
      color: #606060;
    }
    code {
      font-family: Menlo, Monaco, 'Lucida Console', Consolas, monospace;
      font-size: 85%;
      margin: 0;
    }
    pre {
      margin: 1em 0;
      overflow: auto;
    }
    pre code {
      padding: 0;
      overflow: visible;
      overflow-wrap: normal;
    }
    .sourceCode {
     background-color: transparent;
     overflow: visible;
    }
    hr {
      background-color: #1a1a1a;
      border: none;
      height: 1px;
      margin: 1em 0;
    }
    table {
      margin: 1em 0;
      border-collapse: collapse;
      width: 100%;
      overflow-x: auto;
      display: block;
      font-variant-numeric: lining-nums tabular-nums;
    }
    table caption {
      margin-bottom: 0.75em;
    }
    tbody {
      margin-top: 0.5em;
      border-top: 1px solid #1a1a1a;
      border-bottom: 1px solid #1a1a1a;
    }
    th {
      border-top: 1px solid #1a1a1a;
      padding: 0.25em 0.5em 0.25em 0.5em;
    }
    td {
      padding: 0.125em 0.5em 0.25em 0.5em;
    }
    header {
      margin-bottom: 4em;
      text-align: center;
    }
    #TOC li {
      list-style: none;
    }
    #TOC ul {
      padding-left: 1.3em;
    }
    #TOC > ul {
      padding-left: 0;
    }
    #TOC a:not(:hover) {
      text-decoration: none;
    }
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    div.columns{display: flex; gap: min(4vw, 1.5em);}
    div.column{flex: auto; overflow-x: auto;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    ul.task-list{list-style: none;}
    ul.task-list li input[type="checkbox"] {
      width: 0.8em;
      margin: 0 0.8em 0.2em -1.6em;
      vertical-align: middle;
    }
    pre > code.sourceCode { white-space: pre; position: relative; }
    pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
    pre > code.sourceCode > span:empty { height: 1.2em; }
    .sourceCode { overflow: visible; }
    code.sourceCode > span { color: inherit; text-decoration: inherit; }
    div.sourceCode { margin: 1em 0; }
    pre.sourceCode { margin: 0; }
    @media screen {
    div.sourceCode { overflow: auto; }
    }
    @media print {
    pre > code.sourceCode { white-space: pre-wrap; }
    pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
    }
    pre.numberSource code
      { counter-reset: source-line 0; }
    pre.numberSource code > span
      { position: relative; left: -4em; counter-increment: source-line; }
    pre.numberSource code > span > a:first-child::before
      { content: counter(source-line);
        position: relative; left: -1em; text-align: right; vertical-align: baseline;
        border: none; display: inline-block;
        -webkit-touch-callout: none; -webkit-user-select: none;
        -khtml-user-select: none; -moz-user-select: none;
        -ms-user-select: none; user-select: none;
        padding: 0 4px; width: 4em;
        color: #aaaaaa;
      }
    pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
    div.sourceCode
      {   }
    @media screen {
    pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
    }
    code span.al { color: #ff0000; font-weight: bold; } /* Alert */
    code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
    code span.at { color: #7d9029; } /* Attribute */
    code span.bn { color: #40a070; } /* BaseN */
    code span.bu { color: #008000; } /* BuiltIn */
    code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
    code span.ch { color: #4070a0; } /* Char */
    code span.cn { color: #880000; } /* Constant */
    code span.co { color: #60a0b0; font-style: italic; } /* Comment */
    code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
    code span.do { color: #ba2121; font-style: italic; } /* Documentation */
    code span.dt { color: #902000; } /* DataType */
    code span.dv { color: #40a070; } /* DecVal */
    code span.er { color: #ff0000; font-weight: bold; } /* Error */
    code span.ex { } /* Extension */
    code span.fl { color: #40a070; } /* Float */
    code span.fu { color: #06287e; } /* Function */
    code span.im { color: #008000; font-weight: bold; } /* Import */
    code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
    code span.kw { color: #007020; font-weight: bold; } /* Keyword */
    code span.op { color: #666666; } /* Operator */
    code span.ot { color: #007020; } /* Other */
    code span.pp { color: #bc7a00; } /* Preprocessor */
    code span.sc { color: #4070a0; } /* SpecialChar */
    code span.ss { color: #bb6688; } /* SpecialString */
    code span.st { color: #4070a0; } /* String */
    code span.va { color: #19177c; } /* Variable */
    code span.vs { color: #4070a0; } /* VerbatimString */
    code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
    .display.math{display: block; text-align: center; margin: 0.5rem auto;}
  </style>
  <!--[if lt IE 9]>
    <script src="//cdnjs.cloudflare.com/ajax/libs/html5shiv/3.7.3/html5shiv-printshiv.min.js"></script>
  <![endif]-->
</head>
<body>
<div id="bba43c6f" class="cell markdown"
data-papermill="{&quot;duration&quot;:8.876e-3,&quot;end_time&quot;:&quot;2024-05-12T20:57:30.242314&quot;,&quot;exception&quot;:false,&quot;start_time&quot;:&quot;2024-05-12T20:57:30.233438&quot;,&quot;status&quot;:&quot;completed&quot;}"
data-tags="[]">
<div style="background-color:#87CEEB; padding:20px; font-family: 'Garamond', serif;">
    <h1 style="color:#FFFFFF; font-family: 'Garamond', serif;"><strong>Data Analysis on the Relationship of Autism with Facial Expressions in Children</strong></h1>
    <div style="background-color:#ADD8E6; padding:10px; font-family: 'Garamond', serif; text-align: center;">
        <img src="https://imgur.com/c4LYfJG.png" alt="Header Image" style="width:20%; margin: 0 auto;">
    </div>
    <h2 style="color:#FFFFFF; font-family: 'Garamond', serif;">Introduction</h2>
    <p>In this notebook, we will explore the relationship between autism and facial expressions in children. We will analyze a dataset containing facial images of autistic and non-autistic children.</p>
    <div style="background-color:#ADD8E6; padding:10px; font-family: 'Garamond', serif;">
        <h2 style="color:#FFFFFF; font-family: 'Garamond', serif;">Objectives</h2>
        <ul>
            <li>Investigate how facial expressions relate to autism in children.</li>
            <li>Perform visual and statistical analysis to better understand the data.</li>
            <li>Explore the possibility of using facial recognition for early autism detection.</li>
        </ul>
    </div>
    <div style="background-color:#ADD8E6; padding:10px; font-family: 'Garamond', serif;">
        <h2 style="color:#FFFFFF; font-family: 'Garamond', serif;">Dataset</h2>
        <p>The dataset used contains facial images of children labeled as autistic and non-autistic. It was compiled for the purpose of researching the relationship between facial expressions and autism.</p>
    </div>
    <div style="background-color:#ADD8E6; padding:10px; font-family: 'Garamond', serif;">
        <h2 style="color:#FFFFFF; font-family: 'Garamond', serif;">Notebook Structure</h2>
        <ol>
            <li><strong>Data loading and exploration</strong>
                <ul>
                    <li>Import libraries</li>
                    <li>Loading data.</li>
                    <li>Visualizing some samples.</li>
                </ul>
            </li>
            <li><strong>Exploratory data analysis</strong>
                <ul>
                    <li>Descriptive statistics.</li>
                </ul>
            </li>
            <li><strong>Modeling and autism detection</strong>
                <ul>
                    <li>Image preprocessing.</li>
                    <li>Training facial recognition models.</li>
                    <li>Evaluating autism detection capability.</li>
                </ul>
            </li>
        </ol>
    </div>
</div>
</div>
<div id="0e36e335" class="cell markdown"
data-papermill="{&quot;duration&quot;:8.12e-3,&quot;end_time&quot;:&quot;2024-05-12T20:57:30.258848&quot;,&quot;exception&quot;:false,&quot;start_time&quot;:&quot;2024-05-12T20:57:30.250728&quot;,&quot;status&quot;:&quot;completed&quot;}"
data-tags="[]">
<div style="background-color:#87CEEB; padding:20px; font-family: Arial, sans-serif;">
    <h2 style="color:#FFFFFF; font-family: 'Times New Roman', Times, serif;">Data Loading and Exploration</h2>
</div>
</div>
<div id="5601d2b7" class="cell markdown" data-_kg_hide-input="false"
data-papermill="{&quot;duration&quot;:8.019e-3,&quot;end_time&quot;:&quot;2024-05-12T20:57:30.275026&quot;,&quot;exception&quot;:false,&quot;start_time&quot;:&quot;2024-05-12T20:57:30.267007&quot;,&quot;status&quot;:&quot;completed&quot;}"
data-tags="[]">
<div style="background-color:#87CEEB; padding:20px; font-family: Arial, sans-serif;">
<h4 style="color:#FFFFFF; font-family: 'Times New Roman', Times, serif;">Import Libraries</h4>
</div>
</div>
<div id="d3ddf1f9" class="cell markdown" data-_kg_hide-input="false"
data-papermill="{&quot;duration&quot;:8.021e-3,&quot;end_time&quot;:&quot;2024-05-12T20:57:30.291210&quot;,&quot;exception&quot;:false,&quot;start_time&quot;:&quot;2024-05-12T20:57:30.283189&quot;,&quot;status&quot;:&quot;completed&quot;}"
data-tags="[]">
<p>First we are going to import the different libraries that will
conform our project and will help us at the time of the creation of our
neural network.</p>
</div>
<div id="f058e581" class="cell code" data-execution_count="1"
data-_kg_hide-input="false" data-_kg_hide-output="true"
data-execution="{&quot;iopub.execute_input&quot;:&quot;2024-05-12T20:57:30.311048Z&quot;,&quot;iopub.status.busy&quot;:&quot;2024-05-12T20:57:30.310272Z&quot;,&quot;iopub.status.idle&quot;:&quot;2024-05-12T20:57:44.000926Z&quot;,&quot;shell.execute_reply&quot;:&quot;2024-05-12T20:57:44.000109Z&quot;}"
data-papermill="{&quot;duration&quot;:13.702561,&quot;end_time&quot;:&quot;2024-05-12T20:57:44.003283&quot;,&quot;exception&quot;:false,&quot;start_time&quot;:&quot;2024-05-12T20:57:30.300722&quot;,&quot;status&quot;:&quot;completed&quot;}"
data-tags="[]">
<div class="sourceCode" id="cb1"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np </span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd </span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> os</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> cv2</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> tensorflow <span class="im">as</span> tf</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> tensorflow <span class="im">import</span> keras</span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> tensorflow.keras <span class="im">import</span> layers, models</span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> keras.datasets <span class="im">import</span> fashion_mnist</span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> keras.models <span class="im">import</span> Sequential</span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> keras.layers <span class="im">import</span> Dense</span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> keras.optimizers <span class="im">import</span> SGD</span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> keras.utils <span class="im">import</span> to_categorical</span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.image <span class="im">as</span> mpimg</span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb1-19"><a href="#cb1-19" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb1-20"><a href="#cb1-20" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.model_selection <span class="im">import</span> train_test_split</span>
<span id="cb1-21"><a href="#cb1-21" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb1-22"><a href="#cb1-22" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb1-23"><a href="#cb1-23" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> keras.layers <span class="im">import</span> Input</span>
<span id="cb1-24"><a href="#cb1-24" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.preprocessing <span class="im">import</span> LabelEncoder</span>
<span id="cb1-25"><a href="#cb1-25" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.metrics <span class="im">import</span> confusion_matrix</span>
<span id="cb1-26"><a href="#cb1-26" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> seaborn <span class="im">as</span> sns</span>
<span id="cb1-27"><a href="#cb1-27" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.metrics <span class="im">import</span> classification_report</span>
<span id="cb1-28"><a href="#cb1-28" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> sys</span>
<span id="cb1-29"><a href="#cb1-29" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> keras <span class="im">import</span> optimizers, metrics, callbacks</span>
<span id="cb1-30"><a href="#cb1-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-31"><a href="#cb1-31" aria-hidden="true" tabindex="-1"></a></span></code></pre></div>
<div class="output stream stderr">
<pre><code>2024-05-12 20:57:32.919105: E external/local_xla/xla/stream_executor/cuda/cuda_dnn.cc:9261] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
2024-05-12 20:57:32.919206: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:607] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
2024-05-12 20:57:33.056500: E external/local_xla/xla/stream_executor/cuda/cuda_blas.cc:1515] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
</code></pre>
</div>
</div>
<div id="b893a90b" class="cell markdown"
data-papermill="{&quot;duration&quot;:8.371e-3,&quot;end_time&quot;:&quot;2024-05-12T20:57:44.020562&quot;,&quot;exception&quot;:false,&quot;start_time&quot;:&quot;2024-05-12T20:57:44.012191&quot;,&quot;status&quot;:&quot;completed&quot;}"
data-tags="[]">
<div style="background-color:#87CEEB; padding:20px; font-family: Arial, sans-serif;">
<h4 style="color:#FFFFFF; font-family: 'Times New Roman', Times, serif;">Loading Data</h4>
</div>
</div>
<div id="1501e5a0" class="cell markdown"
data-papermill="{&quot;duration&quot;:8.358e-3,&quot;end_time&quot;:&quot;2024-05-12T20:57:44.039339&quot;,&quot;exception&quot;:false,&quot;start_time&quot;:&quot;2024-05-12T20:57:44.030981&quot;,&quot;status&quot;:&quot;completed&quot;}"
data-tags="[]">
<p>In this notebook, our objective is to load the dataset containing
images of both autistic and non-autistic children. This dataset is
organized into three distinct folders: <code>train</code>,
<code>valid</code>, and <code>test</code>, each containing a portion of
the dataset.</p>
<p>Rather than keeping the data separated in these folders, we will
consolidate them into a single dataset. However, before combining the
data, we will perform a shuffle of the images within each folder
individually. This initial step ensures randomness in our dataset, which
is crucial for effective training and evaluation of machine learning
models.</p>
</div>
<div id="90a6a636" class="cell code" data-execution_count="2"
data-execution="{&quot;iopub.execute_input&quot;:&quot;2024-05-12T20:57:44.058030Z&quot;,&quot;iopub.status.busy&quot;:&quot;2024-05-12T20:57:44.057473Z&quot;,&quot;iopub.status.idle&quot;:&quot;2024-05-12T20:58:12.518786Z&quot;,&quot;shell.execute_reply&quot;:&quot;2024-05-12T20:58:12.517939Z&quot;}"
data-papermill="{&quot;duration&quot;:28.473119,&quot;end_time&quot;:&quot;2024-05-12T20:58:12.521074&quot;,&quot;exception&quot;:false,&quot;start_time&quot;:&quot;2024-05-12T20:57:44.047955&quot;,&quot;status&quot;:&quot;completed&quot;}"
data-tags="[]">
<div class="sourceCode" id="cb3"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>train <span class="op">=</span> []</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> dirname, _, filenames <span class="kw">in</span> os.walk(<span class="st">&#39;/kaggle/input&#39;</span>):</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> filename <span class="kw">in</span> filenames:</span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>        full_path <span class="op">=</span> os.path.join(dirname, filename)</span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>        archive<span class="op">=</span>os.path.join(dirname, filename)</span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>        img<span class="op">=</span>cv2.imread(archive)</span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> img <span class="kw">is</span> <span class="kw">not</span> <span class="va">None</span>:</span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a>            img <span class="op">=</span> cv2.resize(img, (<span class="dv">200</span>, <span class="dv">200</span>)) </span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a>            relative_path <span class="op">=</span> os.path.relpath(full_path, <span class="st">&#39;/kaggle/input/autism-facial-image-dataset/Facial images dataset for Autism Detection/&#39;</span>)</span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a>            train.append([img,relative_path,archive])</span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span>:</span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="ss">f&#39;Failed Load Image:</span><span class="sc">{</span>archive<span class="sc">}</span><span class="ss">&#39;</span>)</span></code></pre></div>
</div>
<div id="bda07271" class="cell code" data-execution_count="3"
data-execution="{&quot;iopub.execute_input&quot;:&quot;2024-05-12T20:58:12.540356Z&quot;,&quot;iopub.status.busy&quot;:&quot;2024-05-12T20:58:12.539600Z&quot;,&quot;iopub.status.idle&quot;:&quot;2024-05-12T20:58:12.549513Z&quot;,&quot;shell.execute_reply&quot;:&quot;2024-05-12T20:58:12.548669Z&quot;}"
data-papermill="{&quot;duration&quot;:2.128e-2,&quot;end_time&quot;:&quot;2024-05-12T20:58:12.551379&quot;,&quot;exception&quot;:false,&quot;start_time&quot;:&quot;2024-05-12T20:58:12.530099&quot;,&quot;status&quot;:&quot;completed&quot;}"
data-tags="[]">
<div class="sourceCode" id="cb4"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>train_data <span class="op">=</span> []</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>valid_data <span class="op">=</span> []</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>test_data <span class="op">=</span> []</span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> item <span class="kw">in</span> train:</span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>    full_path <span class="op">=</span> item[<span class="dv">0</span>]</span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a>    label <span class="op">=</span> item[<span class="dv">1</span>].split(<span class="st">&#39;/&#39;</span>)[<span class="dv">1</span>]</span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a>    path<span class="op">=</span>item[<span class="dv">2</span>]</span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a>    is_auth<span class="op">=</span><span class="dv">0</span> <span class="cf">if</span> label <span class="op">==</span> <span class="st">&#39;autistic&#39;</span> <span class="cf">else</span> <span class="dv">1</span></span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a>    train_data.append([full_path, label,path,is_auth])</span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a>np.random.shuffle(train_data)</span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f&#39;There are </span><span class="sc">{</span><span class="bu">len</span>(train_data)<span class="sc">}</span><span class="ss"> images&#39;</span>)</span></code></pre></div>
<div class="output stream stdout">
<pre><code>There are 2926 images
</code></pre>
</div>
</div>
<div id="0086f2ad" class="cell markdown"
data-papermill="{&quot;duration&quot;:8.359e-3,&quot;end_time&quot;:&quot;2024-05-12T20:58:12.568285&quot;,&quot;exception&quot;:false,&quot;start_time&quot;:&quot;2024-05-12T20:58:12.559926&quot;,&quot;status&quot;:&quot;completed&quot;}"
data-tags="[]">
<div style="background-color:#87CEEB; padding:20px; font-family: Arial, sans-serif;">
    <h4 style="color:#FFFFFF; font-family: 'Times New Roman', Times, serif;">Data Visualization</h4></div>
</div>
<div id="e2460572" class="cell markdown"
data-papermill="{&quot;duration&quot;:8.275e-3,&quot;end_time&quot;:&quot;2024-05-12T20:58:12.585055&quot;,&quot;exception&quot;:false,&quot;start_time&quot;:&quot;2024-05-12T20:58:12.576780&quot;,&quot;status&quot;:&quot;completed&quot;}"
data-tags="[]">
<p>Let's create a sample visualization using randomly generated data
obtained earlier. We'll utilize Matplotlib to plot this data, showcasing
its versatility and ease of use. Through this visualization, we can
explore patterns, trends, or distributions within the list,
demonstrating the power of data visualization in understanding and
communicating insights.</p>
</div>
<div id="ff281815" class="cell code" data-execution_count="4"
data-execution="{&quot;iopub.execute_input&quot;:&quot;2024-05-12T20:58:12.603244Z&quot;,&quot;iopub.status.busy&quot;:&quot;2024-05-12T20:58:12.602946Z&quot;,&quot;iopub.status.idle&quot;:&quot;2024-05-12T20:58:14.842074Z&quot;,&quot;shell.execute_reply&quot;:&quot;2024-05-12T20:58:14.840878Z&quot;}"
data-papermill="{&quot;duration&quot;:2.271348,&quot;end_time&quot;:&quot;2024-05-12T20:58:14.864950&quot;,&quot;exception&quot;:false,&quot;start_time&quot;:&quot;2024-05-12T20:58:12.593602&quot;,&quot;status&quot;:&quot;completed&quot;}"
data-tags="[]">
<div class="sourceCode" id="cb6"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> show_images(data):</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>    num_images <span class="op">=</span> <span class="bu">min</span>(<span class="bu">len</span>(data), <span class="dv">20</span>)</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>    fig, axes <span class="op">=</span> plt.subplots(<span class="dv">4</span>, <span class="dv">5</span>, figsize<span class="op">=</span>(<span class="dv">20</span>, <span class="dv">15</span>)) </span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(num_images):</span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>        img_path <span class="op">=</span> data[i][<span class="dv">2</span>]</span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a>        label <span class="op">=</span> data[i][<span class="dv">1</span>]</span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a>        img <span class="op">=</span> mpimg.imread(img_path)</span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a>        row <span class="op">=</span> i <span class="op">//</span> <span class="dv">5</span></span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a>        col <span class="op">=</span> i <span class="op">%</span> <span class="dv">5</span>   </span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true" tabindex="-1"></a>        axes[row, col].imshow(img)</span>
<span id="cb6-11"><a href="#cb6-11" aria-hidden="true" tabindex="-1"></a>        axes[row, col].set_title(label)</span>
<span id="cb6-12"><a href="#cb6-12" aria-hidden="true" tabindex="-1"></a>        axes[row, col].axis(<span class="st">&#39;off&#39;</span>)</span>
<span id="cb6-13"><a href="#cb6-13" aria-hidden="true" tabindex="-1"></a>    plt.subplots_adjust(wspace<span class="op">=</span><span class="fl">0.2</span>, hspace<span class="op">=</span><span class="fl">0.3</span>)</span>
<span id="cb6-14"><a href="#cb6-14" aria-hidden="true" tabindex="-1"></a>    plt.show()</span>
<span id="cb6-15"><a href="#cb6-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-16"><a href="#cb6-16" aria-hidden="true" tabindex="-1"></a>show_images(train_data)</span></code></pre></div>
<div class="output display_data">
<p><img
src="vertopal_2653150e9b964148a0a02e9e2f1e792a/f024b6c48f53295247184a849464a8e511a18dcc.png" /></p>
</div>
</div>
<div id="c3d84633" class="cell markdown"
data-papermill="{&quot;duration&quot;:3.0447e-2,&quot;end_time&quot;:&quot;2024-05-12T20:58:14.925283&quot;,&quot;exception&quot;:false,&quot;start_time&quot;:&quot;2024-05-12T20:58:14.894836&quot;,&quot;status&quot;:&quot;completed&quot;}"
data-tags="[]">
<div style="background-color:#87CEEB; padding:20px; font-family: Arial, sans-serif;">
    <h2 style="color:#FFFFFF; font-family: 'Times New Roman', Times, serif;">Exploratory data analysis</h2></div>
</div>
<div id="78b47ab4" class="cell markdown"
data-papermill="{&quot;duration&quot;:2.9762e-2,&quot;end_time&quot;:&quot;2024-05-12T20:58:14.985169&quot;,&quot;exception&quot;:false,&quot;start_time&quot;:&quot;2024-05-12T20:58:14.955407&quot;,&quot;status&quot;:&quot;completed&quot;}"
data-tags="[]">
<div style="background-color:#87CEEB; padding:20px; font-family: Arial, sans-serif;">
<pre><code>&lt;h4 style=&quot;color:#FFFFFF; font-family: &#39;Times New Roman&#39;, Times, serif;&quot;&gt;Descriptive Stadistics&lt;/h4&gt;&lt;div&gt;</code></pre>
</div>
<div id="a4d2c4ab" class="cell markdown"
data-papermill="{&quot;duration&quot;:2.954e-2,&quot;end_time&quot;:&quot;2024-05-12T20:58:15.044537&quot;,&quot;exception&quot;:false,&quot;start_time&quot;:&quot;2024-05-12T20:58:15.014997&quot;,&quot;status&quot;:&quot;completed&quot;}"
data-tags="[]">
<p>Upon examining the obtained list,we'll conduct an assessment to
determine the count of children with and without autism. This analysis
will provide insights into the distribution of autism diagnosis within
the list.</p>
</div>
<div id="76f63478" class="cell markdown"
data-papermill="{&quot;duration&quot;:2.9782e-2,&quot;end_time&quot;:&quot;2024-05-12T20:58:15.104030&quot;,&quot;exception&quot;:false,&quot;start_time&quot;:&quot;2024-05-12T20:58:15.074248&quot;,&quot;status&quot;:&quot;completed&quot;}"
data-tags="[]">
<h3 id="description-of-the-partitions">Description of the
partitions:</h3>
<ul>
<li>This provides a summary of the 'Autism' column, including count,
unique values, the most frequent value, and frequency of the most
frequent value.</li>
</ul>
<h3 id="value-counts-for-each-partition">Value counts for each
partition:</h3>
<ul>
<li>This shows the count of each unique value in the 'Autism' column,
providing insight into the distribution of data among different
partitions.</li>
</ul>
</div>
<div id="594e5fae" class="cell code" data-execution_count="5"
data-execution="{&quot;iopub.execute_input&quot;:&quot;2024-05-12T20:58:15.166263Z&quot;,&quot;iopub.status.busy&quot;:&quot;2024-05-12T20:58:15.165935Z&quot;,&quot;iopub.status.idle&quot;:&quot;2024-05-12T20:58:15.385008Z&quot;,&quot;shell.execute_reply&quot;:&quot;2024-05-12T20:58:15.384151Z&quot;}"
data-papermill="{&quot;duration&quot;:0.253451,&quot;end_time&quot;:&quot;2024-05-12T20:58:15.387033&quot;,&quot;exception&quot;:false,&quot;start_time&quot;:&quot;2024-05-12T20:58:15.133582&quot;,&quot;status&quot;:&quot;completed&quot;}"
data-tags="[]">
<div class="sourceCode" id="cb8"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> pd.DataFrame(train_data, columns<span class="op">=</span>[<span class="st">&#39;Location&#39;</span>, <span class="st">&#39;Autism&#39;</span>,<span class="st">&#39;TotalLocation&#39;</span>,<span class="st">&#39;Autism_Count&#39;</span>])</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;</span><span class="ch">\n</span><span class="st">Description of Partitions:&quot;</span>)</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(df[<span class="st">&#39;Autism&#39;</span>].describe())</span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;</span><span class="ch">\n</span><span class="st">Value Counts in Each Partition:&quot;</span>)</span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(df[<span class="st">&#39;Autism&#39;</span>].value_counts())</span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">8</span>, <span class="dv">6</span>))</span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a>ax <span class="op">=</span> df[<span class="st">&#39;Autism&#39;</span>].value_counts().plot(kind<span class="op">=</span><span class="st">&#39;bar&#39;</span>, color<span class="op">=</span><span class="st">&#39;skyblue&#39;</span>)</span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">&#39;Distribution of Data&#39;</span>)</span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">&#39;Partition&#39;</span>)</span>
<span id="cb8-10"><a href="#cb8-10" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">&#39;Count&#39;</span>)</span>
<span id="cb8-11"><a href="#cb8-11" aria-hidden="true" tabindex="-1"></a>plt.xticks(rotation<span class="op">=</span><span class="dv">0</span>)</span>
<span id="cb8-12"><a href="#cb8-12" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i, v <span class="kw">in</span> <span class="bu">enumerate</span>(df[<span class="st">&#39;Autism&#39;</span>].value_counts()):</span>
<span id="cb8-13"><a href="#cb8-13" aria-hidden="true" tabindex="-1"></a>    ax.text(i, v <span class="op">+</span> <span class="fl">0.1</span>, <span class="bu">str</span>(v), ha<span class="op">=</span><span class="st">&#39;center&#39;</span>, va<span class="op">=</span><span class="st">&#39;bottom&#39;</span>)</span>
<span id="cb8-14"><a href="#cb8-14" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code></pre></div>
<div class="output stream stdout">
<pre><code>
Description of Partitions:
count             2926
unique               2
top       non_autistic
freq              1463
Name: Autism, dtype: object

Value Counts in Each Partition:
Autism
non_autistic    1463
autistic        1463
Name: count, dtype: int64
</code></pre>
</div>
<div class="output display_data">
<p><img
src="vertopal_2653150e9b964148a0a02e9e2f1e792a/19cbd0557a71f3bd467f3fa884921ea6a8f41887.png" /></p>
</div>
</div>
<div id="a628de69" class="cell markdown"
data-papermill="{&quot;duration&quot;:2.9502e-2,&quot;end_time&quot;:&quot;2024-05-12T20:58:15.447049&quot;,&quot;exception&quot;:false,&quot;start_time&quot;:&quot;2024-05-12T20:58:15.417547&quot;,&quot;status&quot;:&quot;completed&quot;}"
data-tags="[]">
<p>We have been able to verify in the previous deductions that there are
an equal number of cases for autism and non-autism. It was also
determined that there are only these 2 data points for autism and
non-autism.</p>
</div>
<div id="83484489" class="cell markdown"
data-papermill="{&quot;duration&quot;:2.9385e-2,&quot;end_time&quot;:&quot;2024-05-12T20:58:15.506077&quot;,&quot;exception&quot;:false,&quot;start_time&quot;:&quot;2024-05-12T20:58:15.476692&quot;,&quot;status&quot;:&quot;completed&quot;}"
data-tags="[]">
<div style="background-color:#87CEEB; padding:20px; font-family: Arial, sans-serif;">
    <h2 style="color:#FFFFFF; font-family: 'Times New Roman', Times, serif;">Modeling and autism detection</h2></div>
</div>
<div id="960ec361" class="cell markdown"
data-papermill="{&quot;duration&quot;:2.9735e-2,&quot;end_time&quot;:&quot;2024-05-12T20:58:15.565203&quot;,&quot;exception&quot;:false,&quot;start_time&quot;:&quot;2024-05-12T20:58:15.535468&quot;,&quot;status&quot;:&quot;completed&quot;}"
data-tags="[]">
<div style="background-color:#87CEEB; padding:20px; font-family: Arial, sans-serif;">
    <h4 style="color:#FFFFFF; font-family: 'Times New Roman', Times, serif;">Image Preproccesing</h4></div>
</div>
<div id="38301efb" class="cell markdown"
data-papermill="{&quot;duration&quot;:2.9585e-2,&quot;end_time&quot;:&quot;2024-05-12T20:58:15.624374&quot;,&quot;exception&quot;:false,&quot;start_time&quot;:&quot;2024-05-12T20:58:15.594789&quot;,&quot;status&quot;:&quot;completed&quot;}"
data-tags="[]">
<p>We divide the values generated previously in valid test and train
randomly, for this we must select a sample proportional to the amount of
data we have.</p>
</div>
<div id="04b1fd07" class="cell code" data-execution_count="6"
data-execution="{&quot;iopub.execute_input&quot;:&quot;2024-05-12T20:58:15.685433Z&quot;,&quot;iopub.status.busy&quot;:&quot;2024-05-12T20:58:15.684560Z&quot;,&quot;iopub.status.idle&quot;:&quot;2024-05-12T20:58:16.772751Z&quot;,&quot;shell.execute_reply&quot;:&quot;2024-05-12T20:58:16.771547Z&quot;}"
data-papermill="{&quot;duration&quot;:1.121529,&quot;end_time&quot;:&quot;2024-05-12T20:58:16.775070&quot;,&quot;exception&quot;:false,&quot;start_time&quot;:&quot;2024-05-12T20:58:15.653541&quot;,&quot;status&quot;:&quot;completed&quot;}"
data-tags="[]">
<div class="sourceCode" id="cb10"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>y<span class="op">=</span>[]</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>x<span class="op">=</span>[]</span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>np.random.shuffle(train_data)</span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(train_data)):</span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>    x.append(train_data[i][<span class="dv">0</span>])</span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a>    y.append(train_data[i][<span class="dv">3</span>])</span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a>y<span class="op">=</span>np.array(y)</span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a>x<span class="op">=</span>np.array(x)</span>
<span id="cb10-10"><a href="#cb10-10" aria-hidden="true" tabindex="-1"></a>x_train_full,x_test, y_train_full, y_test<span class="op">=</span> train_test_split(x,y,test_size<span class="op">=</span><span class="fl">0.2</span>)</span>
<span id="cb10-11"><a href="#cb10-11" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f&#39;Y has </span><span class="sc">{</span>y_train_full<span class="sc">.</span>shape[<span class="dv">0</span>]<span class="sc">}</span><span class="ss"> values and X has </span><span class="sc">{</span>x_train_full<span class="sc">.</span>shape[<span class="dv">0</span>]<span class="sc">}</span><span class="ss"> values&#39;</span>)</span>
<span id="cb10-12"><a href="#cb10-12" aria-hidden="true" tabindex="-1"></a>X_valid, X_train <span class="op">=</span> x_train_full[:<span class="dv">250</span>] <span class="op">/</span> <span class="fl">255.</span>, x_train_full[<span class="dv">250</span>:] <span class="op">/</span> <span class="fl">255.</span></span>
<span id="cb10-13"><a href="#cb10-13" aria-hidden="true" tabindex="-1"></a>y_valid, y_train <span class="op">=</span> y_train_full[:<span class="dv">250</span>], y_train_full[<span class="dv">250</span>:]</span>
<span id="cb10-14"><a href="#cb10-14" aria-hidden="true" tabindex="-1"></a>X_test <span class="op">=</span> x_test <span class="op">/</span> <span class="fl">255.</span></span></code></pre></div>
<div class="output stream stdout">
<pre><code>Y has 2340 values and X has 2340 values
</code></pre>
</div>
</div>
<div id="2236cdfb" class="cell code" data-execution_count="7"
data-execution="{&quot;iopub.execute_input&quot;:&quot;2024-05-12T20:58:16.838405Z&quot;,&quot;iopub.status.busy&quot;:&quot;2024-05-12T20:58:16.837657Z&quot;,&quot;iopub.status.idle&quot;:&quot;2024-05-12T20:58:16.843656Z&quot;,&quot;shell.execute_reply&quot;:&quot;2024-05-12T20:58:16.842773Z&quot;}"
data-papermill="{&quot;duration&quot;:4.004e-2,&quot;end_time&quot;:&quot;2024-05-12T20:58:16.845567&quot;,&quot;exception&quot;:false,&quot;start_time&quot;:&quot;2024-05-12T20:58:16.805527&quot;,&quot;status&quot;:&quot;completed&quot;}"
data-tags="[]">
<div class="sourceCode" id="cb12"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>x_train_full.shape, y_test.shape</span></code></pre></div>
<div class="output execute_result" data-execution_count="7">
<pre><code>((2340, 200, 200, 3), (586,))</code></pre>
</div>
</div>
<div id="b0c3a736" class="cell markdown"
data-papermill="{&quot;duration&quot;:2.9534e-2,&quot;end_time&quot;:&quot;2024-05-12T20:58:16.905164&quot;,&quot;exception&quot;:false,&quot;start_time&quot;:&quot;2024-05-12T20:58:16.875630&quot;,&quot;status&quot;:&quot;completed&quot;}"
data-tags="[]">
<div style="background-color:#87CEEB; padding:20px; font-family: Arial, sans-serif;">
    <h4 style="color:#FFFFFF; font-family: 'Times New Roman', Times, serif;">Training facial recognition models</h4></div>
</div>
<div id="df9ccb1c" class="cell markdown"
data-papermill="{&quot;duration&quot;:2.958e-2,&quot;end_time&quot;:&quot;2024-05-12T20:58:16.964599&quot;,&quot;exception&quot;:false,&quot;start_time&quot;:&quot;2024-05-12T20:58:16.935019&quot;,&quot;status&quot;:&quot;completed&quot;}"
data-tags="[]">
<p>Now we are going to make the declaration of the model that we are
going to use. It will consist of:</p>
<p><strong>Definition of input and output dimensions:</strong></p>
<ul>
<li><code>input_dimension</code>: Defines the input dimensions of the
model, excluding the channel dimension.</li>
<li><code>dimension_output</code>: Defines the output dimension of the
model, in this case, 1 for binary classification.</li>
</ul>
<p><strong>Sequential Model Definition:</strong></p>
<ul>
<li>Sequential Keras model, a linear stack of layers.</li>
</ul>
<p><strong>Adding Layers to the Model:</strong></p>
<ul>
<li>Convolutional and MaxPooling layers for feature extraction from
images.</li>
<li>Densely connected layers for final classification.</li>
<li>Output layer with sigmoid activation for binary classification
probability.</li>
</ul>
<p><strong>Model Summary:</strong></p>
<ul>
<li>Prints the architecture of the model and the number of trainable
parameters.</li>
</ul>
<p><strong>Model Compilation:</strong></p>
<ul>
<li>Uses the Adam optimizer with a specified learning rate.</li>
<li>Uses binary crossentropy loss function for binary classification
problems.</li>
<li>Defines metrics such as accuracy, precision, and recall to evaluate
model performance during training.</li>
</ul>
</div>
<div id="34521544" class="cell code" data-execution_count="8"
data-execution="{&quot;iopub.execute_input&quot;:&quot;2024-05-12T20:58:17.026457Z&quot;,&quot;iopub.status.busy&quot;:&quot;2024-05-12T20:58:17.026102Z&quot;,&quot;iopub.status.idle&quot;:&quot;2024-05-12T20:58:18.060781Z&quot;,&quot;shell.execute_reply&quot;:&quot;2024-05-12T20:58:18.060029Z&quot;}"
data-papermill="{&quot;duration&quot;:1.067764,&quot;end_time&quot;:&quot;2024-05-12T20:58:18.062656&quot;,&quot;exception&quot;:false,&quot;start_time&quot;:&quot;2024-05-12T20:58:16.994892&quot;,&quot;status&quot;:&quot;completed&quot;}"
data-tags="[]">
<div class="sourceCode" id="cb14"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>dimension_entrada <span class="op">=</span> x_train_full.shape[<span class="dv">1</span>:<span class="dv">4</span>]</span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>dimension_salida <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>model <span class="op">=</span> models.Sequential()</span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a>model.add(layers.Conv2D(<span class="dv">32</span>, (<span class="dv">3</span>,<span class="dv">3</span>), activation<span class="op">=</span><span class="st">&quot;relu&quot;</span>, input_shape<span class="op">=</span>dimension_entrada))</span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a>model.add(layers.BatchNormalization())</span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a>model.add(layers.MaxPooling2D((<span class="dv">2</span>,<span class="dv">2</span>)))</span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a>model.add(layers.Conv2D(<span class="dv">64</span>, (<span class="dv">3</span>,<span class="dv">3</span>), activation<span class="op">=</span><span class="st">&quot;relu&quot;</span>))</span>
<span id="cb14-8"><a href="#cb14-8" aria-hidden="true" tabindex="-1"></a>model.add(layers.BatchNormalization())</span>
<span id="cb14-9"><a href="#cb14-9" aria-hidden="true" tabindex="-1"></a>model.add(layers.MaxPooling2D((<span class="dv">2</span>,<span class="dv">2</span>)))</span>
<span id="cb14-10"><a href="#cb14-10" aria-hidden="true" tabindex="-1"></a>model.add(layers.Conv2D(<span class="dv">128</span>, (<span class="dv">3</span>,<span class="dv">3</span>), activation<span class="op">=</span><span class="st">&quot;relu&quot;</span>))</span>
<span id="cb14-11"><a href="#cb14-11" aria-hidden="true" tabindex="-1"></a>model.add(layers.BatchNormalization())</span>
<span id="cb14-12"><a href="#cb14-12" aria-hidden="true" tabindex="-1"></a>model.add(layers.MaxPooling2D((<span class="dv">2</span>,<span class="dv">2</span>)))</span>
<span id="cb14-13"><a href="#cb14-13" aria-hidden="true" tabindex="-1"></a>model.add(layers.Conv2D(<span class="dv">256</span>, (<span class="dv">3</span>,<span class="dv">3</span>), activation<span class="op">=</span><span class="st">&quot;relu&quot;</span>))</span>
<span id="cb14-14"><a href="#cb14-14" aria-hidden="true" tabindex="-1"></a>model.add(layers.BatchNormalization())</span>
<span id="cb14-15"><a href="#cb14-15" aria-hidden="true" tabindex="-1"></a>model.add(layers.MaxPooling2D((<span class="dv">2</span>,<span class="dv">2</span>)))</span>
<span id="cb14-16"><a href="#cb14-16" aria-hidden="true" tabindex="-1"></a>model.add(layers.Conv2D(<span class="dv">512</span>, (<span class="dv">3</span>,<span class="dv">3</span>), activation<span class="op">=</span><span class="st">&quot;relu&quot;</span>))</span>
<span id="cb14-17"><a href="#cb14-17" aria-hidden="true" tabindex="-1"></a>model.add(layers.BatchNormalization())</span>
<span id="cb14-18"><a href="#cb14-18" aria-hidden="true" tabindex="-1"></a>model.add(layers.MaxPooling2D((<span class="dv">2</span>,<span class="dv">2</span>)))</span>
<span id="cb14-19"><a href="#cb14-19" aria-hidden="true" tabindex="-1"></a>model.add(layers.Flatten())</span>
<span id="cb14-20"><a href="#cb14-20" aria-hidden="true" tabindex="-1"></a><span class="co"># model.add(layers.Dense(512, activation=&quot;relu&quot;))</span></span>
<span id="cb14-21"><a href="#cb14-21" aria-hidden="true" tabindex="-1"></a><span class="co"># model.add(layers.Dropout(0.5)) </span></span>
<span id="cb14-22"><a href="#cb14-22" aria-hidden="true" tabindex="-1"></a>model.add(layers.Dense(<span class="dv">256</span>, activation<span class="op">=</span><span class="st">&quot;relu&quot;</span>))</span>
<span id="cb14-23"><a href="#cb14-23" aria-hidden="true" tabindex="-1"></a>model.add(layers.Dropout(<span class="fl">0.5</span>)) </span>
<span id="cb14-24"><a href="#cb14-24" aria-hidden="true" tabindex="-1"></a>model.add(layers.Dense(<span class="dv">128</span>, activation<span class="op">=</span><span class="st">&quot;relu&quot;</span>))</span>
<span id="cb14-25"><a href="#cb14-25" aria-hidden="true" tabindex="-1"></a>model.add(layers.Dropout(<span class="fl">0.5</span>)) </span>
<span id="cb14-26"><a href="#cb14-26" aria-hidden="true" tabindex="-1"></a>model.add(layers.Dense(<span class="dv">64</span>, activation<span class="op">=</span><span class="st">&quot;relu&quot;</span>))  </span>
<span id="cb14-27"><a href="#cb14-27" aria-hidden="true" tabindex="-1"></a>model.add(layers.Dropout(<span class="fl">0.5</span>)) </span>
<span id="cb14-28"><a href="#cb14-28" aria-hidden="true" tabindex="-1"></a>model.add(layers.Dense(<span class="dv">1</span>, activation<span class="op">=</span><span class="st">&quot;sigmoid&quot;</span>))</span>
<span id="cb14-29"><a href="#cb14-29" aria-hidden="true" tabindex="-1"></a>model.summary()</span>
<span id="cb14-30"><a href="#cb14-30" aria-hidden="true" tabindex="-1"></a>opt <span class="op">=</span> optimizers.Adam(learning_rate<span class="op">=</span><span class="fl">0.00001</span>)</span>
<span id="cb14-31"><a href="#cb14-31" aria-hidden="true" tabindex="-1"></a>model.<span class="bu">compile</span>(loss<span class="op">=</span><span class="st">&quot;binary_crossentropy&quot;</span>, optimizer<span class="op">=</span>opt, metrics<span class="op">=</span>[<span class="st">&quot;accuracy&quot;</span>])</span>
<span id="cb14-32"><a href="#cb14-32" aria-hidden="true" tabindex="-1"></a></span></code></pre></div>
<div class="output stream stderr">
<pre><code>/opt/conda/lib/python3.10/site-packages/keras/src/layers/convolutional/base_conv.py:99: UserWarning: Do not pass an `input_shape`/`input_dim` argument to a layer. When using Sequential models, prefer using an `Input(shape)` object as the first layer in the model instead.
  super().__init__(
</code></pre>
</div>
<div class="output display_data">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"><span style="font-weight: bold">Model: "sequential"</span>
</pre>

</div>
<div class="output display_data">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">
<span style="font-weight: bold"> Layer (type)                    </span><span style="font-weight: bold"> Output Shape           </span><span style="font-weight: bold">       Param # </span>

 conv2d (<span style="color: #0087ff; text-decoration-color: #0087ff">Conv2D</span>)                  (<span style="color: #00d7ff; text-decoration-color: #00d7ff">None</span>, <span style="color: #00af00; text-decoration-color: #00af00">198</span>, <span style="color: #00af00; text-decoration-color: #00af00">198</span>, <span style="color: #00af00; text-decoration-color: #00af00">32</span>)              <span style="color: #00af00; text-decoration-color: #00af00">896</span> 

 batch_normalization              (<span style="color: #00d7ff; text-decoration-color: #00d7ff">None</span>, <span style="color: #00af00; text-decoration-color: #00af00">198</span>, <span style="color: #00af00; text-decoration-color: #00af00">198</span>, <span style="color: #00af00; text-decoration-color: #00af00">32</span>)              <span style="color: #00af00; text-decoration-color: #00af00">128</span> 
 (<span style="color: #0087ff; text-decoration-color: #0087ff">BatchNormalization</span>)                                                   

 max_pooling2d (<span style="color: #0087ff; text-decoration-color: #0087ff">MaxPooling2D</span>)     (<span style="color: #00d7ff; text-decoration-color: #00d7ff">None</span>, <span style="color: #00af00; text-decoration-color: #00af00">99</span>, <span style="color: #00af00; text-decoration-color: #00af00">99</span>, <span style="color: #00af00; text-decoration-color: #00af00">32</span>)                  <span style="color: #00af00; text-decoration-color: #00af00">0</span> 

 conv2d_1 (<span style="color: #0087ff; text-decoration-color: #0087ff">Conv2D</span>)                (<span style="color: #00d7ff; text-decoration-color: #00d7ff">None</span>, <span style="color: #00af00; text-decoration-color: #00af00">97</span>, <span style="color: #00af00; text-decoration-color: #00af00">97</span>, <span style="color: #00af00; text-decoration-color: #00af00">64</span>)             <span style="color: #00af00; text-decoration-color: #00af00">18,496</span> 

 batch_normalization_1            (<span style="color: #00d7ff; text-decoration-color: #00d7ff">None</span>, <span style="color: #00af00; text-decoration-color: #00af00">97</span>, <span style="color: #00af00; text-decoration-color: #00af00">97</span>, <span style="color: #00af00; text-decoration-color: #00af00">64</span>)                <span style="color: #00af00; text-decoration-color: #00af00">256</span> 
 (<span style="color: #0087ff; text-decoration-color: #0087ff">BatchNormalization</span>)                                                   

 max_pooling2d_1 (<span style="color: #0087ff; text-decoration-color: #0087ff">MaxPooling2D</span>)   (<span style="color: #00d7ff; text-decoration-color: #00d7ff">None</span>, <span style="color: #00af00; text-decoration-color: #00af00">48</span>, <span style="color: #00af00; text-decoration-color: #00af00">48</span>, <span style="color: #00af00; text-decoration-color: #00af00">64</span>)                  <span style="color: #00af00; text-decoration-color: #00af00">0</span> 

 conv2d_2 (<span style="color: #0087ff; text-decoration-color: #0087ff">Conv2D</span>)                (<span style="color: #00d7ff; text-decoration-color: #00d7ff">None</span>, <span style="color: #00af00; text-decoration-color: #00af00">46</span>, <span style="color: #00af00; text-decoration-color: #00af00">46</span>, <span style="color: #00af00; text-decoration-color: #00af00">128</span>)            <span style="color: #00af00; text-decoration-color: #00af00">73,856</span> 

 batch_normalization_2            (<span style="color: #00d7ff; text-decoration-color: #00d7ff">None</span>, <span style="color: #00af00; text-decoration-color: #00af00">46</span>, <span style="color: #00af00; text-decoration-color: #00af00">46</span>, <span style="color: #00af00; text-decoration-color: #00af00">128</span>)               <span style="color: #00af00; text-decoration-color: #00af00">512</span> 
 (<span style="color: #0087ff; text-decoration-color: #0087ff">BatchNormalization</span>)                                                   

 max_pooling2d_2 (<span style="color: #0087ff; text-decoration-color: #0087ff">MaxPooling2D</span>)   (<span style="color: #00d7ff; text-decoration-color: #00d7ff">None</span>, <span style="color: #00af00; text-decoration-color: #00af00">23</span>, <span style="color: #00af00; text-decoration-color: #00af00">23</span>, <span style="color: #00af00; text-decoration-color: #00af00">128</span>)                 <span style="color: #00af00; text-decoration-color: #00af00">0</span> 

 conv2d_3 (<span style="color: #0087ff; text-decoration-color: #0087ff">Conv2D</span>)                (<span style="color: #00d7ff; text-decoration-color: #00d7ff">None</span>, <span style="color: #00af00; text-decoration-color: #00af00">21</span>, <span style="color: #00af00; text-decoration-color: #00af00">21</span>, <span style="color: #00af00; text-decoration-color: #00af00">256</span>)           <span style="color: #00af00; text-decoration-color: #00af00">295,168</span> 

 batch_normalization_3            (<span style="color: #00d7ff; text-decoration-color: #00d7ff">None</span>, <span style="color: #00af00; text-decoration-color: #00af00">21</span>, <span style="color: #00af00; text-decoration-color: #00af00">21</span>, <span style="color: #00af00; text-decoration-color: #00af00">256</span>)             <span style="color: #00af00; text-decoration-color: #00af00">1,024</span> 
 (<span style="color: #0087ff; text-decoration-color: #0087ff">BatchNormalization</span>)                                                   

 max_pooling2d_3 (<span style="color: #0087ff; text-decoration-color: #0087ff">MaxPooling2D</span>)   (<span style="color: #00d7ff; text-decoration-color: #00d7ff">None</span>, <span style="color: #00af00; text-decoration-color: #00af00">10</span>, <span style="color: #00af00; text-decoration-color: #00af00">10</span>, <span style="color: #00af00; text-decoration-color: #00af00">256</span>)                 <span style="color: #00af00; text-decoration-color: #00af00">0</span> 

 conv2d_4 (<span style="color: #0087ff; text-decoration-color: #0087ff">Conv2D</span>)                (<span style="color: #00d7ff; text-decoration-color: #00d7ff">None</span>, <span style="color: #00af00; text-decoration-color: #00af00">8</span>, <span style="color: #00af00; text-decoration-color: #00af00">8</span>, <span style="color: #00af00; text-decoration-color: #00af00">512</span>)           <span style="color: #00af00; text-decoration-color: #00af00">1,180,160</span> 

 batch_normalization_4            (<span style="color: #00d7ff; text-decoration-color: #00d7ff">None</span>, <span style="color: #00af00; text-decoration-color: #00af00">8</span>, <span style="color: #00af00; text-decoration-color: #00af00">8</span>, <span style="color: #00af00; text-decoration-color: #00af00">512</span>)               <span style="color: #00af00; text-decoration-color: #00af00">2,048</span> 
 (<span style="color: #0087ff; text-decoration-color: #0087ff">BatchNormalization</span>)                                                   

 max_pooling2d_4 (<span style="color: #0087ff; text-decoration-color: #0087ff">MaxPooling2D</span>)   (<span style="color: #00d7ff; text-decoration-color: #00d7ff">None</span>, <span style="color: #00af00; text-decoration-color: #00af00">4</span>, <span style="color: #00af00; text-decoration-color: #00af00">4</span>, <span style="color: #00af00; text-decoration-color: #00af00">512</span>)                   <span style="color: #00af00; text-decoration-color: #00af00">0</span> 

 flatten (<span style="color: #0087ff; text-decoration-color: #0087ff">Flatten</span>)                (<span style="color: #00d7ff; text-decoration-color: #00d7ff">None</span>, <span style="color: #00af00; text-decoration-color: #00af00">8192</span>)                        <span style="color: #00af00; text-decoration-color: #00af00">0</span> 

 dense (<span style="color: #0087ff; text-decoration-color: #0087ff">Dense</span>)                    (<span style="color: #00d7ff; text-decoration-color: #00d7ff">None</span>, <span style="color: #00af00; text-decoration-color: #00af00">256</span>)                 <span style="color: #00af00; text-decoration-color: #00af00">2,097,408</span> 

 dropout (<span style="color: #0087ff; text-decoration-color: #0087ff">Dropout</span>)                (<span style="color: #00d7ff; text-decoration-color: #00d7ff">None</span>, <span style="color: #00af00; text-decoration-color: #00af00">256</span>)                         <span style="color: #00af00; text-decoration-color: #00af00">0</span> 

 dense_1 (<span style="color: #0087ff; text-decoration-color: #0087ff">Dense</span>)                  (<span style="color: #00d7ff; text-decoration-color: #00d7ff">None</span>, <span style="color: #00af00; text-decoration-color: #00af00">128</span>)                    <span style="color: #00af00; text-decoration-color: #00af00">32,896</span> 

 dropout_1 (<span style="color: #0087ff; text-decoration-color: #0087ff">Dropout</span>)              (<span style="color: #00d7ff; text-decoration-color: #00d7ff">None</span>, <span style="color: #00af00; text-decoration-color: #00af00">128</span>)                         <span style="color: #00af00; text-decoration-color: #00af00">0</span> 

 dense_2 (<span style="color: #0087ff; text-decoration-color: #0087ff">Dense</span>)                  (<span style="color: #00d7ff; text-decoration-color: #00d7ff">None</span>, <span style="color: #00af00; text-decoration-color: #00af00">64</span>)                      <span style="color: #00af00; text-decoration-color: #00af00">8,256</span> 

 dropout_2 (<span style="color: #0087ff; text-decoration-color: #0087ff">Dropout</span>)              (<span style="color: #00d7ff; text-decoration-color: #00d7ff">None</span>, <span style="color: #00af00; text-decoration-color: #00af00">64</span>)                          <span style="color: #00af00; text-decoration-color: #00af00">0</span> 

 dense_3 (<span style="color: #0087ff; text-decoration-color: #0087ff">Dense</span>)                  (<span style="color: #00d7ff; text-decoration-color: #00d7ff">None</span>, <span style="color: #00af00; text-decoration-color: #00af00">1</span>)                          <span style="color: #00af00; text-decoration-color: #00af00">65</span> 

</pre>

</div>
<div class="output display_data">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"><span style="font-weight: bold"> Total params: </span><span style="color: #00af00; text-decoration-color: #00af00">3,711,169</span> (14.16 MB)
</pre>

</div>
<div class="output display_data">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"><span style="font-weight: bold"> Trainable params: </span><span style="color: #00af00; text-decoration-color: #00af00">3,709,185</span> (14.15 MB)
</pre>

</div>
<div class="output display_data">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"><span style="font-weight: bold"> Non-trainable params: </span><span style="color: #00af00; text-decoration-color: #00af00">1,984</span> (7.75 KB)
</pre>

</div>
</div>
<div id="98df168e" class="cell markdown"
data-papermill="{&quot;duration&quot;:3.48e-2,&quot;end_time&quot;:&quot;2024-05-12T20:58:18.134484&quot;,&quot;exception&quot;:false,&quot;start_time&quot;:&quot;2024-05-12T20:58:18.099684&quot;,&quot;status&quot;:&quot;completed&quot;}"
data-tags="[]">
<p>We will now start with the previously launched model:</p>
</div>
<div id="6a7c0fb4" class="cell code" data-execution_count="9"
data-_kg_hide-input="false" data-_kg_hide-output="true"
data-execution="{&quot;iopub.execute_input&quot;:&quot;2024-05-12T20:58:18.205320Z&quot;,&quot;iopub.status.busy&quot;:&quot;2024-05-12T20:58:18.204552Z&quot;,&quot;iopub.status.idle&quot;:&quot;2024-05-12T21:00:54.193057Z&quot;,&quot;shell.execute_reply&quot;:&quot;2024-05-12T21:00:54.192172Z&quot;}"
data-papermill="{&quot;duration&quot;:156.025777,&quot;end_time&quot;:&quot;2024-05-12T21:00:54.195326&quot;,&quot;exception&quot;:false,&quot;start_time&quot;:&quot;2024-05-12T20:58:18.169549&quot;,&quot;status&quot;:&quot;completed&quot;}"
data-tags="[]">
<div class="sourceCode" id="cb16"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>early_stopping_cb <span class="op">=</span> keras.callbacks.EarlyStopping(patience<span class="op">=</span><span class="dv">10</span>,restore_best_weights<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>history <span class="op">=</span> model.fit(X_train,y_train,epochs<span class="op">=</span>sys.maxsize,validation_data<span class="op">=</span>(X_valid,y_valid),callbacks<span class="op">=</span>[early_stopping_cb])</span></code></pre></div>
<div class="output stream stdout">
<pre><code>Epoch 1/9223372036854775807
</code></pre>
</div>
<div class="output stream stderr">
<pre><code>2024-05-12 20:58:28.711232: E external/local_xla/xla/service/gpu/buffer_comparator.cc:1137] Difference at 65: 5.41783, expected 4.72242
2024-05-12 20:58:28.711286: E external/local_xla/xla/service/gpu/buffer_comparator.cc:1137] Difference at 66: 4.33458, expected 3.63917
2024-05-12 20:58:28.711296: E external/local_xla/xla/service/gpu/buffer_comparator.cc:1137] Difference at 141: 5.05684, expected 4.36143
2024-05-12 20:58:28.711304: E external/local_xla/xla/service/gpu/buffer_comparator.cc:1137] Difference at 142: 5.83136, expected 5.13595
2024-05-12 20:58:28.711312: E external/local_xla/xla/service/gpu/buffer_comparator.cc:1137] Difference at 143: 5.29561, expected 4.6002
2024-05-12 20:58:28.711320: E external/local_xla/xla/service/gpu/buffer_comparator.cc:1137] Difference at 216: 5.34702, expected 4.65161
2024-05-12 20:58:28.711328: E external/local_xla/xla/service/gpu/buffer_comparator.cc:1137] Difference at 264: 5.29538, expected 4.59997
2024-05-12 20:58:28.711336: E external/local_xla/xla/service/gpu/buffer_comparator.cc:1137] Difference at 339: 5.43918, expected 4.74376
2024-05-12 20:58:28.711343: E external/local_xla/xla/service/gpu/buffer_comparator.cc:1137] Difference at 340: 4.69161, expected 3.9962
2024-05-12 20:58:28.711351: E external/local_xla/xla/service/gpu/buffer_comparator.cc:1137] Difference at 341: 4.86162, expected 4.1662
2024-05-12 20:58:28.729686: E external/local_xla/xla/service/gpu/conv_algorithm_picker.cc:705] Results mismatch between different convolution algorithms. This is likely a bug/unexpected loss of precision in cudnn.
(f32[32,32,198,198]{3,2,1,0}, u8[0]{0}) custom-call(f32[32,3,200,200]{3,2,1,0}, f32[32,3,3,3]{3,2,1,0}, f32[32]{0}), window={size=3x3}, dim_labels=bf01_oi01-&gt;bf01, custom_call_target=&quot;__cudnn$convBiasActivationForward&quot;, backend_config={&quot;conv_result_scale&quot;:1,&quot;activation_mode&quot;:&quot;kRelu&quot;,&quot;side_input_scale&quot;:0,&quot;leakyrelu_alpha&quot;:0} for eng20{k2=2,k4=1,k5=1,k6=0,k7=0} vs eng15{k5=1,k6=0,k7=1,k10=1}
2024-05-12 20:58:28.729741: E external/local_xla/xla/service/gpu/conv_algorithm_picker.cc:270] Device: Tesla P100-PCIE-16GB
2024-05-12 20:58:28.729750: E external/local_xla/xla/service/gpu/conv_algorithm_picker.cc:271] Platform: Compute Capability 6.0
2024-05-12 20:58:28.729757: E external/local_xla/xla/service/gpu/conv_algorithm_picker.cc:272] Driver: 12020 (535.129.3)
2024-05-12 20:58:28.729764: E external/local_xla/xla/service/gpu/conv_algorithm_picker.cc:273] Runtime: &lt;undefined&gt;
2024-05-12 20:58:28.729780: E external/local_xla/xla/service/gpu/conv_algorithm_picker.cc:280] cudnn version: 8.9.0
2024-05-12 20:58:29.341777: E external/local_xla/xla/service/gpu/buffer_comparator.cc:1137] Difference at 65: 5.41783, expected 4.72242
2024-05-12 20:58:29.341836: E external/local_xla/xla/service/gpu/buffer_comparator.cc:1137] Difference at 66: 4.33458, expected 3.63917
2024-05-12 20:58:29.341846: E external/local_xla/xla/service/gpu/buffer_comparator.cc:1137] Difference at 141: 5.05684, expected 4.36143
2024-05-12 20:58:29.341854: E external/local_xla/xla/service/gpu/buffer_comparator.cc:1137] Difference at 142: 5.83136, expected 5.13595
2024-05-12 20:58:29.341861: E external/local_xla/xla/service/gpu/buffer_comparator.cc:1137] Difference at 143: 5.29561, expected 4.6002
2024-05-12 20:58:29.341869: E external/local_xla/xla/service/gpu/buffer_comparator.cc:1137] Difference at 216: 5.34702, expected 4.65161
2024-05-12 20:58:29.341877: E external/local_xla/xla/service/gpu/buffer_comparator.cc:1137] Difference at 264: 5.29538, expected 4.59997
2024-05-12 20:58:29.341885: E external/local_xla/xla/service/gpu/buffer_comparator.cc:1137] Difference at 339: 5.43918, expected 4.74376
2024-05-12 20:58:29.341893: E external/local_xla/xla/service/gpu/buffer_comparator.cc:1137] Difference at 340: 4.69161, expected 3.9962
2024-05-12 20:58:29.341900: E external/local_xla/xla/service/gpu/buffer_comparator.cc:1137] Difference at 341: 4.86162, expected 4.1662
2024-05-12 20:58:29.359351: E external/local_xla/xla/service/gpu/conv_algorithm_picker.cc:705] Results mismatch between different convolution algorithms. This is likely a bug/unexpected loss of precision in cudnn.
(f32[32,32,198,198]{3,2,1,0}, u8[0]{0}) custom-call(f32[32,3,200,200]{3,2,1,0}, f32[32,3,3,3]{3,2,1,0}, f32[32]{0}), window={size=3x3}, dim_labels=bf01_oi01-&gt;bf01, custom_call_target=&quot;__cudnn$convBiasActivationForward&quot;, backend_config={&quot;conv_result_scale&quot;:1,&quot;activation_mode&quot;:&quot;kRelu&quot;,&quot;side_input_scale&quot;:0,&quot;leakyrelu_alpha&quot;:0} for eng20{k2=2,k4=1,k5=1,k6=0,k7=0} vs eng15{k5=1,k6=0,k7=1,k10=1}
2024-05-12 20:58:29.359394: E external/local_xla/xla/service/gpu/conv_algorithm_picker.cc:270] Device: Tesla P100-PCIE-16GB
2024-05-12 20:58:29.359403: E external/local_xla/xla/service/gpu/conv_algorithm_picker.cc:271] Platform: Compute Capability 6.0
2024-05-12 20:58:29.359410: E external/local_xla/xla/service/gpu/conv_algorithm_picker.cc:272] Driver: 12020 (535.129.3)
2024-05-12 20:58:29.359416: E external/local_xla/xla/service/gpu/conv_algorithm_picker.cc:273] Runtime: &lt;undefined&gt;
2024-05-12 20:58:29.359438: E external/local_xla/xla/service/gpu/conv_algorithm_picker.cc:280] cudnn version: 8.9.0
</code></pre>
</div>
<div class="output stream stdout">
<pre><code> 5/66  2s 33ms/step - accuracy: 0.5469 - loss: 1.5669</code></pre>
</div>
<div class="output stream stderr">
<pre><code>WARNING: All log messages before absl::InitializeLog() is called are written to STDERR
I0000 00:00:1715547517.678552      71 device_compiler.h:186] Compiled cluster using XLA!  This line is logged at most once for the lifetime of the process.
</code></pre>
</div>
<div class="output stream stdout">
<pre><code>65/66  0s 31ms/step - accuracy: 0.5111 - loss: 1.5027</code></pre>
</div>
<div class="output stream stderr">
<pre><code>2024-05-12 20:58:42.275288: E external/local_xla/xla/service/gpu/buffer_comparator.cc:1137] Difference at 39270: 4.54897, expected 3.8847
2024-05-12 20:58:42.275350: E external/local_xla/xla/service/gpu/buffer_comparator.cc:1137] Difference at 39271: 5.56504, expected 4.90076
2024-05-12 20:58:42.275360: E external/local_xla/xla/service/gpu/buffer_comparator.cc:1137] Difference at 39346: 5.13362, expected 4.46934
2024-05-12 20:58:42.275368: E external/local_xla/xla/service/gpu/buffer_comparator.cc:1137] Difference at 39347: 5.39993, expected 4.73565
2024-05-12 20:58:42.275376: E external/local_xla/xla/service/gpu/buffer_comparator.cc:1137] Difference at 39468: 4.65743, expected 3.99315
2024-05-12 20:58:42.275384: E external/local_xla/xla/service/gpu/buffer_comparator.cc:1137] Difference at 39544: 4.67595, expected 4.01167
2024-05-12 20:58:42.275392: E external/local_xla/xla/service/gpu/buffer_comparator.cc:1137] Difference at 39545: 4.23047, expected 3.56619
2024-05-12 20:58:42.275399: E external/local_xla/xla/service/gpu/buffer_comparator.cc:1137] Difference at 39618: 5.25602, expected 4.59174
2024-05-12 20:58:42.275408: E external/local_xla/xla/service/gpu/buffer_comparator.cc:1137] Difference at 39742: 5.30235, expected 4.63807
2024-05-12 20:58:42.275415: E external/local_xla/xla/service/gpu/buffer_comparator.cc:1137] Difference at 39743: 4.48614, expected 3.82186
2024-05-12 20:58:42.281194: E external/local_xla/xla/service/gpu/conv_algorithm_picker.cc:705] Results mismatch between different convolution algorithms. This is likely a bug/unexpected loss of precision in cudnn.
(f32[10,32,198,198]{3,2,1,0}, u8[0]{0}) custom-call(f32[10,3,200,200]{3,2,1,0}, f32[32,3,3,3]{3,2,1,0}, f32[32]{0}), window={size=3x3}, dim_labels=bf01_oi01-&gt;bf01, custom_call_target=&quot;__cudnn$convBiasActivationForward&quot;, backend_config={&quot;conv_result_scale&quot;:1,&quot;activation_mode&quot;:&quot;kRelu&quot;,&quot;side_input_scale&quot;:0,&quot;leakyrelu_alpha&quot;:0} for eng20{k2=2,k4=1,k5=1,k6=0,k7=0} vs eng15{k5=1,k6=0,k7=1,k10=1}
2024-05-12 20:58:42.281225: E external/local_xla/xla/service/gpu/conv_algorithm_picker.cc:270] Device: Tesla P100-PCIE-16GB
2024-05-12 20:58:42.281234: E external/local_xla/xla/service/gpu/conv_algorithm_picker.cc:271] Platform: Compute Capability 6.0
2024-05-12 20:58:42.281242: E external/local_xla/xla/service/gpu/conv_algorithm_picker.cc:272] Driver: 12020 (535.129.3)
2024-05-12 20:58:42.281250: E external/local_xla/xla/service/gpu/conv_algorithm_picker.cc:273] Runtime: &lt;undefined&gt;
2024-05-12 20:58:42.281266: E external/local_xla/xla/service/gpu/conv_algorithm_picker.cc:280] cudnn version: 8.9.0
2024-05-12 20:58:42.435847: E external/local_xla/xla/service/gpu/buffer_comparator.cc:1137] Difference at 39270: 4.54897, expected 3.8847
2024-05-12 20:58:42.435897: E external/local_xla/xla/service/gpu/buffer_comparator.cc:1137] Difference at 39271: 5.56504, expected 4.90076
2024-05-12 20:58:42.435907: E external/local_xla/xla/service/gpu/buffer_comparator.cc:1137] Difference at 39346: 5.13362, expected 4.46934
2024-05-12 20:58:42.435915: E external/local_xla/xla/service/gpu/buffer_comparator.cc:1137] Difference at 39347: 5.39993, expected 4.73565
2024-05-12 20:58:42.435923: E external/local_xla/xla/service/gpu/buffer_comparator.cc:1137] Difference at 39468: 4.65743, expected 3.99315
2024-05-12 20:58:42.435931: E external/local_xla/xla/service/gpu/buffer_comparator.cc:1137] Difference at 39544: 4.67595, expected 4.01167
2024-05-12 20:58:42.435939: E external/local_xla/xla/service/gpu/buffer_comparator.cc:1137] Difference at 39545: 4.23047, expected 3.56619
2024-05-12 20:58:42.435947: E external/local_xla/xla/service/gpu/buffer_comparator.cc:1137] Difference at 39618: 5.25602, expected 4.59174
2024-05-12 20:58:42.435954: E external/local_xla/xla/service/gpu/buffer_comparator.cc:1137] Difference at 39742: 5.30235, expected 4.63807
2024-05-12 20:58:42.435962: E external/local_xla/xla/service/gpu/buffer_comparator.cc:1137] Difference at 39743: 4.48614, expected 3.82186
2024-05-12 20:58:42.441508: E external/local_xla/xla/service/gpu/conv_algorithm_picker.cc:705] Results mismatch between different convolution algorithms. This is likely a bug/unexpected loss of precision in cudnn.
(f32[10,32,198,198]{3,2,1,0}, u8[0]{0}) custom-call(f32[10,3,200,200]{3,2,1,0}, f32[32,3,3,3]{3,2,1,0}, f32[32]{0}), window={size=3x3}, dim_labels=bf01_oi01-&gt;bf01, custom_call_target=&quot;__cudnn$convBiasActivationForward&quot;, backend_config={&quot;conv_result_scale&quot;:1,&quot;activation_mode&quot;:&quot;kRelu&quot;,&quot;side_input_scale&quot;:0,&quot;leakyrelu_alpha&quot;:0} for eng20{k2=2,k4=1,k5=1,k6=0,k7=0} vs eng15{k5=1,k6=0,k7=1,k10=1}
2024-05-12 20:58:42.441541: E external/local_xla/xla/service/gpu/conv_algorithm_picker.cc:270] Device: Tesla P100-PCIE-16GB
2024-05-12 20:58:42.441551: E external/local_xla/xla/service/gpu/conv_algorithm_picker.cc:271] Platform: Compute Capability 6.0
2024-05-12 20:58:42.441558: E external/local_xla/xla/service/gpu/conv_algorithm_picker.cc:272] Driver: 12020 (535.129.3)
2024-05-12 20:58:42.441566: E external/local_xla/xla/service/gpu/conv_algorithm_picker.cc:273] Runtime: &lt;undefined&gt;
2024-05-12 20:58:42.441582: E external/local_xla/xla/service/gpu/conv_algorithm_picker.cc:280] cudnn version: 8.9.0
</code></pre>
</div>
<div class="output stream stdout">
<pre><code>66/66  0s 169ms/step - accuracy: 0.5111 - loss: 1.5006</code></pre>
</div>
<div class="output stream stderr">
<pre><code>2024-05-12 20:58:50.279918: E external/local_xla/xla/service/gpu/buffer_comparator.cc:1137] Difference at 117678: 3.90812, expected 3.37558
2024-05-12 20:58:50.279974: E external/local_xla/xla/service/gpu/buffer_comparator.cc:1137] Difference at 117715: 4.24471, expected 3.71217
2024-05-12 20:58:50.279984: E external/local_xla/xla/service/gpu/buffer_comparator.cc:1137] Difference at 117754: 4.16554, expected 3.633
2024-05-12 20:58:50.279993: E external/local_xla/xla/service/gpu/buffer_comparator.cc:1137] Difference at 117827: 4.20254, expected 3.67
2024-05-12 20:58:50.280001: E external/local_xla/xla/service/gpu/buffer_comparator.cc:1137] Difference at 117952: 3.1382, expected 2.60566
2024-05-12 20:58:50.280010: E external/local_xla/xla/service/gpu/buffer_comparator.cc:1137] Difference at 118150: 3.74092, expected 3.20838
2024-05-12 20:58:50.280019: E external/local_xla/xla/service/gpu/buffer_comparator.cc:1137] Difference at 118418: 4.2852, expected 3.75266
2024-05-12 20:58:50.280028: E external/local_xla/xla/service/gpu/buffer_comparator.cc:1137] Difference at 118791: 4.29326, expected 3.76072
2024-05-12 20:58:50.280036: E external/local_xla/xla/service/gpu/buffer_comparator.cc:1137] Difference at 118871: 4.26869, expected 3.73616
2024-05-12 20:58:50.280044: E external/local_xla/xla/service/gpu/buffer_comparator.cc:1137] Difference at 118941: 3.25332, expected 2.72078
2024-05-12 20:58:50.294290: E external/local_xla/xla/service/gpu/conv_algorithm_picker.cc:705] Results mismatch between different convolution algorithms. This is likely a bug/unexpected loss of precision in cudnn.
(f32[26,32,198,198]{3,2,1,0}, u8[0]{0}) custom-call(f32[26,3,200,200]{3,2,1,0}, f32[32,3,3,3]{3,2,1,0}, f32[32]{0}), window={size=3x3}, dim_labels=bf01_oi01-&gt;bf01, custom_call_target=&quot;__cudnn$convBiasActivationForward&quot;, backend_config={&quot;conv_result_scale&quot;:1,&quot;activation_mode&quot;:&quot;kRelu&quot;,&quot;side_input_scale&quot;:0,&quot;leakyrelu_alpha&quot;:0} for eng20{k2=2,k4=1,k5=1,k6=0,k7=0} vs eng15{k5=1,k6=0,k7=1,k10=1}
2024-05-12 20:58:50.294331: E external/local_xla/xla/service/gpu/conv_algorithm_picker.cc:270] Device: Tesla P100-PCIE-16GB
2024-05-12 20:58:50.294339: E external/local_xla/xla/service/gpu/conv_algorithm_picker.cc:271] Platform: Compute Capability 6.0
2024-05-12 20:58:50.294346: E external/local_xla/xla/service/gpu/conv_algorithm_picker.cc:272] Driver: 12020 (535.129.3)
2024-05-12 20:58:50.294353: E external/local_xla/xla/service/gpu/conv_algorithm_picker.cc:273] Runtime: &lt;undefined&gt;
2024-05-12 20:58:50.294368: E external/local_xla/xla/service/gpu/conv_algorithm_picker.cc:280] cudnn version: 8.9.0
2024-05-12 20:58:50.666434: E external/local_xla/xla/service/gpu/buffer_comparator.cc:1137] Difference at 117678: 3.90812, expected 3.37558
2024-05-12 20:58:50.666490: E external/local_xla/xla/service/gpu/buffer_comparator.cc:1137] Difference at 117715: 4.24471, expected 3.71217
2024-05-12 20:58:50.666500: E external/local_xla/xla/service/gpu/buffer_comparator.cc:1137] Difference at 117754: 4.16554, expected 3.633
2024-05-12 20:58:50.666508: E external/local_xla/xla/service/gpu/buffer_comparator.cc:1137] Difference at 117827: 4.20254, expected 3.67
2024-05-12 20:58:50.666517: E external/local_xla/xla/service/gpu/buffer_comparator.cc:1137] Difference at 117952: 3.1382, expected 2.60566
2024-05-12 20:58:50.666525: E external/local_xla/xla/service/gpu/buffer_comparator.cc:1137] Difference at 118150: 3.74092, expected 3.20838
2024-05-12 20:58:50.666534: E external/local_xla/xla/service/gpu/buffer_comparator.cc:1137] Difference at 118418: 4.2852, expected 3.75266
2024-05-12 20:58:50.666543: E external/local_xla/xla/service/gpu/buffer_comparator.cc:1137] Difference at 118791: 4.29326, expected 3.76072
2024-05-12 20:58:50.666551: E external/local_xla/xla/service/gpu/buffer_comparator.cc:1137] Difference at 118871: 4.26869, expected 3.73616
2024-05-12 20:58:50.666559: E external/local_xla/xla/service/gpu/buffer_comparator.cc:1137] Difference at 118941: 3.25332, expected 2.72078
2024-05-12 20:58:50.680777: E external/local_xla/xla/service/gpu/conv_algorithm_picker.cc:705] Results mismatch between different convolution algorithms. This is likely a bug/unexpected loss of precision in cudnn.
(f32[26,32,198,198]{3,2,1,0}, u8[0]{0}) custom-call(f32[26,3,200,200]{3,2,1,0}, f32[32,3,3,3]{3,2,1,0}, f32[32]{0}), window={size=3x3}, dim_labels=bf01_oi01-&gt;bf01, custom_call_target=&quot;__cudnn$convBiasActivationForward&quot;, backend_config={&quot;conv_result_scale&quot;:1,&quot;activation_mode&quot;:&quot;kRelu&quot;,&quot;side_input_scale&quot;:0,&quot;leakyrelu_alpha&quot;:0} for eng20{k2=2,k4=1,k5=1,k6=0,k7=0} vs eng15{k5=1,k6=0,k7=1,k10=1}
2024-05-12 20:58:50.680809: E external/local_xla/xla/service/gpu/conv_algorithm_picker.cc:270] Device: Tesla P100-PCIE-16GB
2024-05-12 20:58:50.680817: E external/local_xla/xla/service/gpu/conv_algorithm_picker.cc:271] Platform: Compute Capability 6.0
2024-05-12 20:58:50.680825: E external/local_xla/xla/service/gpu/conv_algorithm_picker.cc:272] Driver: 12020 (535.129.3)
2024-05-12 20:58:50.680831: E external/local_xla/xla/service/gpu/conv_algorithm_picker.cc:273] Runtime: &lt;undefined&gt;
2024-05-12 20:58:50.680846: E external/local_xla/xla/service/gpu/conv_algorithm_picker.cc:280] cudnn version: 8.9.0
</code></pre>
</div>
<div class="output stream stdout">
<pre><code>66/66  31s 222ms/step - accuracy: 0.5110 - loss: 1.4984 - val_accuracy: 0.4920 - val_loss: 0.7064
Epoch 2/9223372036854775807
66/66  2s 33ms/step - accuracy: 0.5459 - loss: 1.0437 - val_accuracy: 0.4920 - val_loss: 0.7725
Epoch 3/9223372036854775807
66/66  2s 33ms/step - accuracy: 0.5715 - loss: 0.9336 - val_accuracy: 0.4920 - val_loss: 0.8777
Epoch 4/9223372036854775807
66/66  2s 33ms/step - accuracy: 0.5984 - loss: 0.8723 - val_accuracy: 0.4920 - val_loss: 0.9035
Epoch 5/9223372036854775807
66/66  2s 33ms/step - accuracy: 0.6106 - loss: 0.7461 - val_accuracy: 0.5000 - val_loss: 0.8355
Epoch 6/9223372036854775807
66/66  2s 33ms/step - accuracy: 0.6096 - loss: 0.7323 - val_accuracy: 0.5360 - val_loss: 0.7367
Epoch 7/9223372036854775807
66/66  2s 33ms/step - accuracy: 0.6408 - loss: 0.7024 - val_accuracy: 0.5760 - val_loss: 0.6610
Epoch 8/9223372036854775807
66/66  2s 33ms/step - accuracy: 0.6431 - loss: 0.6627 - val_accuracy: 0.6280 - val_loss: 0.6053
Epoch 9/9223372036854775807
66/66  2s 33ms/step - accuracy: 0.6443 - loss: 0.6596 - val_accuracy: 0.7000 - val_loss: 0.5697
Epoch 10/9223372036854775807
66/66  2s 33ms/step - accuracy: 0.6546 - loss: 0.6460 - val_accuracy: 0.7120 - val_loss: 0.5612
Epoch 11/9223372036854775807
66/66  2s 34ms/step - accuracy: 0.7032 - loss: 0.5981 - val_accuracy: 0.7200 - val_loss: 0.5477
Epoch 12/9223372036854775807
66/66  2s 33ms/step - accuracy: 0.6753 - loss: 0.6362 - val_accuracy: 0.7400 - val_loss: 0.5387
Epoch 13/9223372036854775807
66/66  2s 33ms/step - accuracy: 0.6733 - loss: 0.6105 - val_accuracy: 0.7400 - val_loss: 0.5303
Epoch 14/9223372036854775807
66/66  2s 33ms/step - accuracy: 0.6995 - loss: 0.5829 - val_accuracy: 0.7520 - val_loss: 0.5305
Epoch 15/9223372036854775807
66/66  2s 33ms/step - accuracy: 0.6892 - loss: 0.5629 - val_accuracy: 0.7200 - val_loss: 0.5283
Epoch 16/9223372036854775807
66/66  2s 33ms/step - accuracy: 0.7037 - loss: 0.5474 - val_accuracy: 0.7240 - val_loss: 0.5295
Epoch 17/9223372036854775807
66/66  2s 33ms/step - accuracy: 0.7152 - loss: 0.5373 - val_accuracy: 0.7280 - val_loss: 0.5313
Epoch 18/9223372036854775807
66/66  2s 33ms/step - accuracy: 0.7350 - loss: 0.5437 - val_accuracy: 0.7400 - val_loss: 0.5227
Epoch 19/9223372036854775807
66/66  2s 33ms/step - accuracy: 0.7063 - loss: 0.5615 - val_accuracy: 0.7480 - val_loss: 0.5172
Epoch 20/9223372036854775807
66/66  2s 33ms/step - accuracy: 0.7239 - loss: 0.5382 - val_accuracy: 0.7440 - val_loss: 0.5178
Epoch 21/9223372036854775807
66/66  2s 33ms/step - accuracy: 0.7399 - loss: 0.5182 - val_accuracy: 0.7520 - val_loss: 0.5166
Epoch 22/9223372036854775807
66/66  2s 33ms/step - accuracy: 0.7428 - loss: 0.5135 - val_accuracy: 0.7480 - val_loss: 0.5208
Epoch 23/9223372036854775807
66/66  2s 33ms/step - accuracy: 0.7393 - loss: 0.5050 - val_accuracy: 0.7560 - val_loss: 0.5165
Epoch 24/9223372036854775807
66/66  2s 33ms/step - accuracy: 0.7601 - loss: 0.4790 - val_accuracy: 0.7600 - val_loss: 0.5138
Epoch 25/9223372036854775807
66/66  2s 33ms/step - accuracy: 0.7597 - loss: 0.4750 - val_accuracy: 0.7680 - val_loss: 0.5081
Epoch 26/9223372036854775807
66/66  2s 33ms/step - accuracy: 0.7668 - loss: 0.4683 - val_accuracy: 0.7720 - val_loss: 0.5096
Epoch 27/9223372036854775807
66/66  2s 33ms/step - accuracy: 0.7582 - loss: 0.4726 - val_accuracy: 0.7600 - val_loss: 0.5059
Epoch 28/9223372036854775807
66/66  2s 33ms/step - accuracy: 0.7967 - loss: 0.4454 - val_accuracy: 0.7600 - val_loss: 0.5081
Epoch 29/9223372036854775807
66/66  2s 33ms/step - accuracy: 0.7784 - loss: 0.4504 - val_accuracy: 0.7760 - val_loss: 0.5059
Epoch 30/9223372036854775807
66/66  2s 33ms/step - accuracy: 0.7679 - loss: 0.4612 - val_accuracy: 0.7640 - val_loss: 0.5037
Epoch 31/9223372036854775807
66/66  2s 33ms/step - accuracy: 0.7888 - loss: 0.4295 - val_accuracy: 0.7840 - val_loss: 0.4990
Epoch 32/9223372036854775807
66/66  2s 33ms/step - accuracy: 0.7766 - loss: 0.4351 - val_accuracy: 0.7800 - val_loss: 0.4953
Epoch 33/9223372036854775807
66/66  2s 33ms/step - accuracy: 0.8112 - loss: 0.3970 - val_accuracy: 0.7720 - val_loss: 0.4972
Epoch 34/9223372036854775807
66/66  2s 33ms/step - accuracy: 0.8220 - loss: 0.3747 - val_accuracy: 0.7720 - val_loss: 0.5074
Epoch 35/9223372036854775807
66/66  2s 33ms/step - accuracy: 0.8010 - loss: 0.4087 - val_accuracy: 0.7800 - val_loss: 0.4989
Epoch 36/9223372036854775807
66/66  2s 33ms/step - accuracy: 0.8222 - loss: 0.3780 - val_accuracy: 0.7800 - val_loss: 0.4937
Epoch 37/9223372036854775807
66/66  2s 33ms/step - accuracy: 0.8269 - loss: 0.3727 - val_accuracy: 0.7800 - val_loss: 0.5016
Epoch 38/9223372036854775807
66/66  2s 33ms/step - accuracy: 0.8280 - loss: 0.3725 - val_accuracy: 0.7960 - val_loss: 0.4997
Epoch 39/9223372036854775807
66/66  2s 34ms/step - accuracy: 0.8185 - loss: 0.3875 - val_accuracy: 0.7800 - val_loss: 0.4860
Epoch 40/9223372036854775807
66/66  2s 33ms/step - accuracy: 0.8262 - loss: 0.3788 - val_accuracy: 0.7800 - val_loss: 0.4870
Epoch 41/9223372036854775807
66/66  2s 33ms/step - accuracy: 0.8284 - loss: 0.3830 - val_accuracy: 0.7840 - val_loss: 0.4867
Epoch 42/9223372036854775807
66/66  2s 33ms/step - accuracy: 0.8260 - loss: 0.3548 - val_accuracy: 0.7880 - val_loss: 0.4918
Epoch 43/9223372036854775807
66/66  2s 33ms/step - accuracy: 0.8539 - loss: 0.3373 - val_accuracy: 0.7840 - val_loss: 0.4901
Epoch 44/9223372036854775807
66/66  2s 33ms/step - accuracy: 0.8400 - loss: 0.3493 - val_accuracy: 0.7840 - val_loss: 0.4838
Epoch 45/9223372036854775807
66/66  2s 33ms/step - accuracy: 0.8434 - loss: 0.3301 - val_accuracy: 0.7840 - val_loss: 0.4864
Epoch 46/9223372036854775807
66/66  2s 33ms/step - accuracy: 0.8570 - loss: 0.3148 - val_accuracy: 0.7840 - val_loss: 0.4838
Epoch 47/9223372036854775807
66/66  2s 33ms/step - accuracy: 0.8633 - loss: 0.3270 - val_accuracy: 0.7840 - val_loss: 0.4897
Epoch 48/9223372036854775807
66/66  2s 33ms/step - accuracy: 0.8699 - loss: 0.3136 - val_accuracy: 0.7800 - val_loss: 0.4991
Epoch 49/9223372036854775807
66/66  2s 33ms/step - accuracy: 0.8646 - loss: 0.2934 - val_accuracy: 0.8040 - val_loss: 0.4886
Epoch 50/9223372036854775807
66/66  2s 33ms/step - accuracy: 0.8750 - loss: 0.2942 - val_accuracy: 0.7960 - val_loss: 0.4916
Epoch 51/9223372036854775807
66/66  2s 33ms/step - accuracy: 0.8929 - loss: 0.2549 - val_accuracy: 0.7880 - val_loss: 0.4865
Epoch 52/9223372036854775807
66/66  2s 34ms/step - accuracy: 0.8973 - loss: 0.2602 - val_accuracy: 0.7920 - val_loss: 0.4941
Epoch 53/9223372036854775807
66/66  2s 33ms/step - accuracy: 0.8865 - loss: 0.2626 - val_accuracy: 0.7960 - val_loss: 0.4987
Epoch 54/9223372036854775807
66/66  2s 33ms/step - accuracy: 0.9031 - loss: 0.2282 - val_accuracy: 0.8080 - val_loss: 0.5130
Epoch 55/9223372036854775807
66/66  2s 33ms/step - accuracy: 0.8945 - loss: 0.2578 - val_accuracy: 0.7960 - val_loss: 0.5047
Epoch 56/9223372036854775807
66/66  2s 33ms/step - accuracy: 0.9101 - loss: 0.2264 - val_accuracy: 0.8040 - val_loss: 0.4959
</code></pre>
</div>
</div>
<div id="7cb92a79" class="cell markdown"
data-papermill="{&quot;duration&quot;:0.191186,&quot;end_time&quot;:&quot;2024-05-12T21:00:54.580045&quot;,&quot;exception&quot;:false,&quot;start_time&quot;:&quot;2024-05-12T21:00:54.388859&quot;,&quot;status&quot;:&quot;completed&quot;}"
data-tags="[]">
<p>We can observe the different values that take the orders assigned by
us in the following graph, we can observe that the val loss and val take
similar trends as well as accuracy and val accuracy.</p>
</div>
<div id="e9e99b5a" class="cell code" data-execution_count="10"
data-execution="{&quot;iopub.execute_input&quot;:&quot;2024-05-12T21:00:54.967566Z&quot;,&quot;iopub.status.busy&quot;:&quot;2024-05-12T21:00:54.966865Z&quot;,&quot;iopub.status.idle&quot;:&quot;2024-05-12T21:00:55.183579Z&quot;,&quot;shell.execute_reply&quot;:&quot;2024-05-12T21:00:55.182862Z&quot;}"
data-papermill="{&quot;duration&quot;:0.412191,&quot;end_time&quot;:&quot;2024-05-12T21:00:55.185478&quot;,&quot;exception&quot;:false,&quot;start_time&quot;:&quot;2024-05-12T21:00:54.773287&quot;,&quot;status&quot;:&quot;completed&quot;}"
data-tags="[]">
<div class="sourceCode" id="cb26"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>pd.DataFrame(history.history).plot(figsize<span class="op">=</span>(<span class="dv">8</span>, <span class="dv">5</span>))</span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a>plt.grid(<span class="va">True</span>)</span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a>plt.gca().set_ylim(<span class="dv">0</span>, <span class="dv">1</span>)</span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code></pre></div>
<div class="output display_data">
<p><img
src="vertopal_2653150e9b964148a0a02e9e2f1e792a/06fdebb071b71e917e7a3e7ffd92aef9f0bb8fcd.png" /></p>
</div>
</div>
<div id="01930466" class="cell markdown"
data-papermill="{&quot;duration&quot;:0.191188,&quot;end_time&quot;:&quot;2024-05-12T21:00:55.568673&quot;,&quot;exception&quot;:false,&quot;start_time&quot;:&quot;2024-05-12T21:00:55.377485&quot;,&quot;status&quot;:&quot;completed&quot;}"
data-tags="[]">
<div style="background-color:#87CEEB; padding:20px; font-family: Arial, sans-serif;">
    <h4 style="color:#FFFFFF; font-family: 'Times New Roman', Times, serif;">Evaluating autism detection capability</h4></div>
</div>
<div id="8e2d5afd" class="cell markdown"
data-papermill="{&quot;duration&quot;:0.191464,&quot;end_time&quot;:&quot;2024-05-12T21:00:55.953774&quot;,&quot;exception&quot;:false,&quot;start_time&quot;:&quot;2024-05-12T21:00:55.762310&quot;,&quot;status&quot;:&quot;completed&quot;}"
data-tags="[]">
<p>Finally, we will evaluate the model once the training is
finished.</p>
</div>
<div id="c478663e" class="cell code" data-execution_count="11"
data-execution="{&quot;iopub.execute_input&quot;:&quot;2024-05-12T21:00:56.358051Z&quot;,&quot;iopub.status.busy&quot;:&quot;2024-05-12T21:00:56.357403Z&quot;,&quot;iopub.status.idle&quot;:&quot;2024-05-12T21:00:57.852382Z&quot;,&quot;shell.execute_reply&quot;:&quot;2024-05-12T21:00:57.851336Z&quot;}"
data-papermill="{&quot;duration&quot;:1.688616,&quot;end_time&quot;:&quot;2024-05-12T21:00:57.854434&quot;,&quot;exception&quot;:false,&quot;start_time&quot;:&quot;2024-05-12T21:00:56.165818&quot;,&quot;status&quot;:&quot;completed&quot;}"
data-tags="[]">
<div class="sourceCode" id="cb27"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a>evaluation<span class="op">=</span>model.evaluate(X_test, y_test)</span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>accuracy <span class="op">=</span> evaluation[<span class="dv">1</span>]</span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a>val_loss <span class="op">=</span> evaluation[<span class="dv">0</span>]</span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a><span class="co"># val_accuracy = evaluation[3]</span></span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;Accuracy:&quot;</span>, accuracy)</span>
<span id="cb27-6"><a href="#cb27-6" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;Validation Loss:&quot;</span>, val_loss)</span>
<span id="cb27-7"><a href="#cb27-7" aria-hidden="true" tabindex="-1"></a><span class="co"># print(&quot;Validation Accuracy:&quot;, val_accuracy)</span></span></code></pre></div>
<div class="output stream stdout">
<pre><code>19/19  1s 37ms/step - accuracy: 0.7989 - loss: 0.4438
Accuracy: 0.7918089032173157
Validation Loss: 0.4540463089942932
</code></pre>
</div>
</div>
<div id="e4843523" class="cell markdown"
data-papermill="{&quot;duration&quot;:0.191113,&quot;end_time&quot;:&quot;2024-05-12T21:00:58.237022&quot;,&quot;exception&quot;:false,&quot;start_time&quot;:&quot;2024-05-12T21:00:58.045909&quot;,&quot;status&quot;:&quot;completed&quot;}"
data-tags="[]">
<p>Here we can see in a confusion matrix the data that have been correct
in the diagonal and in the inverse diagonal the data that have been
wrongly assigned by the model.</p>
</div>
<div id="a03c78fd" class="cell code" data-execution_count="12"
data-execution="{&quot;iopub.execute_input&quot;:&quot;2024-05-12T21:00:58.623403Z&quot;,&quot;iopub.status.busy&quot;:&quot;2024-05-12T21:00:58.622236Z&quot;,&quot;iopub.status.idle&quot;:&quot;2024-05-12T21:01:00.930385Z&quot;,&quot;shell.execute_reply&quot;:&quot;2024-05-12T21:01:00.929362Z&quot;}"
data-papermill="{&quot;duration&quot;:2.504324,&quot;end_time&quot;:&quot;2024-05-12T21:01:00.932362&quot;,&quot;exception&quot;:false,&quot;start_time&quot;:&quot;2024-05-12T21:00:58.428038&quot;,&quot;status&quot;:&quot;completed&quot;}"
data-tags="[]">
<div class="sourceCode" id="cb29"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a>y_test_pred <span class="op">=</span> model.predict(X_test)</span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a>y_test_pred_labels <span class="op">=</span> y_test_pred <span class="op">&gt;</span> <span class="fl">0.5</span></span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a>y_test_true_labels <span class="op">=</span> y_test</span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a>cm <span class="op">=</span> confusion_matrix(y_test_true_labels, y_test_pred_labels)</span>
<span id="cb29-5"><a href="#cb29-5" aria-hidden="true" tabindex="-1"></a>sns.heatmap(cm, annot<span class="op">=</span><span class="va">True</span>, fmt<span class="op">=</span><span class="st">&#39;d&#39;</span>,cmap<span class="op">=</span><span class="st">&quot;crest&quot;</span>,linewidths<span class="op">=</span><span class="fl">.5</span>)</span>
<span id="cb29-6"><a href="#cb29-6" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code></pre></div>
<div class="output stream stdout">
<pre><code>19/19  1s 39ms/step
</code></pre>
</div>
<div class="output display_data">
<p><img
src="vertopal_2653150e9b964148a0a02e9e2f1e792a/2c728e0551945dace36df9f722ca6e712b31e2ef.png" /></p>
</div>
</div>
<div id="95b71fa1" class="cell markdown"
data-papermill="{&quot;duration&quot;:0.193036,&quot;end_time&quot;:&quot;2024-05-12T21:01:01.321862&quot;,&quot;exception&quot;:false,&quot;start_time&quot;:&quot;2024-05-12T21:01:01.128826&quot;,&quot;status&quot;:&quot;completed&quot;}"
data-tags="[]">
<p>The <code>classification_report</code> function generates a detailed
report that includes various metrics to evaluate the performance of a
classification model. It compares the true labels
(<code>y_test_true_labels</code>) with the predicted labels
(<code>y_test_pred_labels</code>) and computes metrics such as
precision, recall, F1-score, and support for each class. These metrics
provide insights into how well the model is performing for each class in
the classification problem.</p>
</div>
<div id="68d70a1f" class="cell code" data-execution_count="13"
data-execution="{&quot;iopub.execute_input&quot;:&quot;2024-05-12T21:01:01.737652Z&quot;,&quot;iopub.status.busy&quot;:&quot;2024-05-12T21:01:01.737257Z&quot;,&quot;iopub.status.idle&quot;:&quot;2024-05-12T21:01:01.754484Z&quot;,&quot;shell.execute_reply&quot;:&quot;2024-05-12T21:01:01.752656Z&quot;}"
data-papermill="{&quot;duration&quot;:0.230846,&quot;end_time&quot;:&quot;2024-05-12T21:01:01.756965&quot;,&quot;exception&quot;:false,&quot;start_time&quot;:&quot;2024-05-12T21:01:01.526119&quot;,&quot;status&quot;:&quot;completed&quot;}"
data-tags="[]">
<div class="sourceCode" id="cb31"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a>report <span class="op">=</span> classification_report(y_test_true_labels, y_test_pred_labels, digits<span class="op">=</span><span class="dv">4</span>)</span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(report)</span></code></pre></div>
<div class="output stream stdout">
<pre><code>              precision    recall  f1-score   support

           0     0.7987    0.8039    0.8013       306
           1     0.7842    0.7786    0.7814       280

    accuracy                         0.7918       586
   macro avg     0.7914    0.7912    0.7913       586
weighted avg     0.7918    0.7918    0.7918       586

</code></pre>
</div>
</div>
<div id="06b7848e" class="cell code" data-execution_count="14"
data-execution="{&quot;iopub.execute_input&quot;:&quot;2024-05-12T21:01:02.185197Z&quot;,&quot;iopub.status.busy&quot;:&quot;2024-05-12T21:01:02.184822Z&quot;,&quot;iopub.status.idle&quot;:&quot;2024-05-12T21:01:09.012434Z&quot;,&quot;shell.execute_reply&quot;:&quot;2024-05-12T21:01:09.011470Z&quot;}"
data-papermill="{&quot;duration&quot;:7.068792,&quot;end_time&quot;:&quot;2024-05-12T21:01:09.041039&quot;,&quot;exception&quot;:false,&quot;start_time&quot;:&quot;2024-05-12T21:01:01.972247&quot;,&quot;status&quot;:&quot;completed&quot;}"
data-tags="[]">
<div class="sourceCode" id="cb33"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> plot_image_with_labels(image, true_label, pred_label, ax):</span>
<span id="cb33-4"><a href="#cb33-4" aria-hidden="true" tabindex="-1"></a>    ax.imshow(image, cmap<span class="op">=</span><span class="st">&#39;gray&#39;</span>)</span>
<span id="cb33-5"><a href="#cb33-5" aria-hidden="true" tabindex="-1"></a>    ax.axis(<span class="st">&#39;off&#39;</span>)</span>
<span id="cb33-6"><a href="#cb33-6" aria-hidden="true" tabindex="-1"></a>    ax.set_title(<span class="ss">f&#39;Real: </span><span class="sc">{</span>true_label<span class="sc">}</span><span class="ch">\n</span><span class="ss">Predicted: </span><span class="sc">{</span>pred_label<span class="sc">}</span><span class="ss">&#39;</span>, fontsize<span class="op">=</span><span class="dv">10</span>)</span>
<span id="cb33-7"><a href="#cb33-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-8"><a href="#cb33-8" aria-hidden="true" tabindex="-1"></a>fig, axs <span class="op">=</span> plt.subplots(nrows<span class="op">=</span><span class="dv">20</span>, ncols<span class="op">=</span><span class="dv">5</span>, figsize<span class="op">=</span>(<span class="dv">12</span>, <span class="dv">30</span>))</span>
<span id="cb33-9"><a href="#cb33-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-10"><a href="#cb33-10" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">100</span>): </span>
<span id="cb33-11"><a href="#cb33-11" aria-hidden="true" tabindex="-1"></a>    image <span class="op">=</span> x_test[i]</span>
<span id="cb33-12"><a href="#cb33-12" aria-hidden="true" tabindex="-1"></a>    true_label <span class="op">=</span> <span class="st">&#39;autist&#39;</span> <span class="cf">if</span> y_test_true_labels[i] <span class="op">==</span> <span class="dv">0</span> <span class="cf">else</span> <span class="st">&#39;non_autist&#39;</span></span>
<span id="cb33-13"><a href="#cb33-13" aria-hidden="true" tabindex="-1"></a>    pred_label <span class="op">=</span> <span class="st">&#39;autist&#39;</span> <span class="cf">if</span> y_test_pred_labels[i] <span class="op">==</span> <span class="dv">0</span> <span class="cf">else</span> <span class="st">&#39;non_autist&#39;</span></span>
<span id="cb33-14"><a href="#cb33-14" aria-hidden="true" tabindex="-1"></a>    plot_image_with_labels(image, true_label, pred_label, axs[i <span class="op">//</span> <span class="dv">5</span>, i <span class="op">%</span> <span class="dv">5</span>])</span>
<span id="cb33-15"><a href="#cb33-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-16"><a href="#cb33-16" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> row <span class="kw">in</span> axs:</span>
<span id="cb33-17"><a href="#cb33-17" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> ax <span class="kw">in</span> row:</span>
<span id="cb33-18"><a href="#cb33-18" aria-hidden="true" tabindex="-1"></a>        ax.axis(<span class="st">&#39;off&#39;</span>)</span>
<span id="cb33-19"><a href="#cb33-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-20"><a href="#cb33-20" aria-hidden="true" tabindex="-1"></a>plt.tight_layout()</span>
<span id="cb33-21"><a href="#cb33-21" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code></pre></div>
<div class="output display_data">
<p><img
src="vertopal_2653150e9b964148a0a02e9e2f1e792a/d189acbb6325e468d21d664cb3be098163696eb0.png" /></p>
</div>
</div>
</body>
</html>
